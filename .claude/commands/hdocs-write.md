# 한컴독스 문서 작성 통합 (/hdocs-write)

한컴독스 웹 에디터에서 문서를 자동으로 작성하는 통합 워크플로우 skill.
CLAUDE.md 내장 기능(탐색/스타일/표)과 비기본 skill(format, page, insert)을 조합한다.

사용자 요청: $ARGUMENTS

---

## 실행 전 절차

1. **에디터 탭 확인**: `tabs_context_mcp` → 한컴독스 에디터 탭 식별
2. **에디터 상태 확인**: screenshot으로 현재 상태 확인
3. **기존 다이얼로그 닫기**: 열려있으면 Escape

---

## ★ 온디맨드 워크플로우 원칙

### 핵심: 본문 작성 즉시 시작, 설정은 필요할 때만

모든 설정(용지, 스타일, 머리말/꼬리말 등)을 사전에 일괄 수행하지 않는다.
**본문 작성을 즉시 시작**하고, 각 설정은 **처음 필요해지는 시점**에 수행한다.

```
[잘못된 접근 - 순차 설정]
F7 용지 → 스타일 전체 편집 → 머리말/꼬리말 → 그제서야 본문 시작
→ 설정 단계에서 시간 낭비, 불필요한 설정까지 수행

[올바른 접근 - 온디맨드]
본문 작성 시작 → 제목 스타일 필요? → 그때 F6으로 해당 스타일만 편집
→ 표 필요? → 그때 표 생성 → 꼬리말 필요? → 본문 완성 후 추가
```

### 온디맨드 의사결정 흐름

```
1. 새 문서 / 기존 문서 판단
   - 새 문서: 기본값(A4) 확인만 → 바로 본문 시작
   - 기존 문서: get_page_text로 톤앤매너 빠르게 파악 → 바로 이어 작성

2. 본문 작성 중 설정이 필요해지면:
   [제목 입력 시] → 스타일 확인/편집 (해당 스타일만)
   [표 삽입 시]  → 표 생성 + 캡션
   [용지 변경 시] → F7 (기본값이면 건너뜀)
   [쪽번호 필요 시] → 본문 완성 후 꼬리말 설정

3. 본문 완성 후 마무리:
   - 머리말/꼬리말 (필요시)
   - 최종 검토 + 저장
```

### 설정별 수행 시점

| 설정 | 수행 시점 | 건너뛰는 조건 |
|------|----------|-------------|
| F7 편집 용지 | 용지/여백 변경 필요 시 | A4 세로 기본값이면 건너뜀 |
| 스타일 편집 | 해당 스타일을 처음 사용할 때 | 기본값이 적합하면 건너뜀 |
| 스타일 추가 | 커스텀 스타일이 처음 필요할 때 | 기존 스타일로 충분하면 건너뜀 |
| 머리말/꼬리말 | 본문 완성 후 | 불필요하면 건너뜀 |
| 쪽번호 | 본문 완성 후 | 1~2쪽 문서면 건너뜀 |

---

## 온디맨드 레시피

### 레시피 1: 기존 문서 분석 (기존 문서에 추가/수정 시)

```
1. get_page_text 또는 screenshot으로 현재 내용 빠르게 파악
2. 번호 체계, 어미, 서식 패턴 확인
3. F6 열기 → JS로 Ctrl+숫자 매핑 추출 → Escape (필요할 때만)
4. 파악한 패턴에 맞춰 바로 작성 시작
```

**번호 체계 파악 체크리스트:**
- 장(제N장), 절(N.1), 소절(N.1.1) 구조 여부
- 기호 계층: □ → ○ → - → · → ※ 또는 다른 체계
- 표/그림 캡션 형식: `<표 N-M>` 또는 `[표 N-M]` 등
- 출처 표기: `자료:` / `주:` / `출처:`
- 어미: ~임, ~이다, ~합니다, ~함 등

### 레시피 2: 용지 설정 (필요할 때만)

기본값(A4 세로)이 적합하면 **건너뛴다**.
```
F7 → 용지/방향/여백 변경 → 확인
```

→ 문서 유형별 여백 참고값: hdocs-page B절 "공문서 기본 여백" 및 F7 다이얼로그 설정 절차 참조

### 레시피 3: 스타일 온디맨드 설정

**원칙**: 스타일은 처음 사용할 때 확인하고, 부적합하면 그때 편집한다.

```
[시나리오 A: 제목을 처음 입력할 때]
1. F6 열기 → 개요 1 속성 확인 (10pt 기본값?)
2. 부적합하면: JS "설정..." → 18pt/볼드/가운데 등 편집 → 확인
3. Ctrl+숫자로 적용 → 제목 입력
4. ★ 이후 같은 스타일은 편집 없이 Ctrl+숫자만 사용

[시나리오 B: 커스텀 스타일이 필요할 때]
1. F6 → 추가(+) → 이름 입력 → 확인
2. JS "설정..." → 속성 설정 → 확인 → F6 닫기
3. Ctrl+숫자로 적용 (매핑 순서 확인)

[시나리오 C: 여러 스타일을 한꺼번에 만들어야 할 때]
→ 배치 생성 (CLAUDE.md 스타일 관리 G절): 이름 일괄 등록(1패스) → 속성 일괄 설정(2패스)
→ 이 경우에만 사전 설정이 합리적 (본문 시작 전)
```

**⚠ "설정..." 버튼 JS 클릭**: CLAUDE.md 스타일 관리 D절 JS 코드 사용 (btns[0]=문단, btns[1]=글자, btns[2]=글머리표)

### 레시피 4: 본문 작성 (고속 입력)

스타일이 준비되었으면 **Ctrl+숫자 하나로 모든 서식이 자동 적용**.

**간단한 문서 (개요 기반):**
```
Ctrl+3 → type("문서 제목") → Enter
Ctrl+1 → type("본문 첫 단락 전체를 한 번에 입력한다.") → Enter
Ctrl+4 → type("소제목") → Enter
Ctrl+1 → type("본문 내용...") → Enter
```

**실전 보고서 (표준 번호 체계):**
```
[절 제목]  Ctrl+3 → type("3.1 해외 시장·산업동향") → Enter
[대주제]   Ctrl+5 → type("□ 글로벌 반도체 시장 현황") → Enter
[본문Lv1]  Ctrl+6 → type("○ 반도체 시장은 TSMC, 삼성전자 등 주요 파운드리가 글로벌 공급을 주도") → Enter
[본문Lv2]  Ctrl+7 → type("- (점유율) TSMC - 54.4%, 삼성전자 - 16.5%") → Enter
[참고]     Ctrl+9 → type("※ 상기 점유율은 2024년 기준이며 IDM 자체 생산분 제외") → Enter
```
위 숫자는 예시 (실제 번호는 F6 스타일 목록 순서에 따라 다름)

**속도 최적화:**
- **단락 전체를 한 번의 type()으로 입력** (문장마다 나누지 않음)
- 500자 초과 시에만 분할
- 스타일 전환(Ctrl+숫자)과 type()만 반복 → 스크린샷 중간 확인 불필요
- 한글 IME: type() 후 다음 type()은 대기 불필요. **Ctrl+숫자 전에만** 짧은 대기

### 레시피 5: 장 표지 생성 ★

쪽나누기 → Enter×10~12 → 가운데+20pt+볼드 → 제목 → 쪽나누기.
→ 상세 절차: hdocs-page E절 "장 표지 생성 패턴" 참조

### 레시피 6: 표 삽입 + 캡션/출처

```
1. 표 제목 스타일 적용 → type("<표 N-M> 표 제목") → Enter
2. (단위 필요시) type("(단위: 억 원, %)") → 오른쪽 정렬 → Enter
3. 표 만들기 (Alt+N → T → 행/열 수 → 확인)
4. 헤더 행: 각 셀에 Ctrl+B → type → Tab 반복 (볼드 전파 안 됨!)
5. 데이터 행: type → Tab 반복 (배치 입력)
6. Shift+Esc로 표 탈출
7. ⚠ 필수 검증: screenshot으로 커서가 표 바깥인지 확인. 커서 안 보이면 재촬영. 검증 통과 전 본문 입력 금지. 실패 시 Shift+Esc 재시도
8. ArrowDown으로 표 아래 이동, 또는 표 아래 영역 직접 클릭. 최후 수단: Ctrl+End(문서 끝 점프)
9. type("주: 설명 내용") → Enter (필요시)
10. type("자료: 출처명(연도), 제목") → Enter
11. Enter (빈 줄) → 본문 스타일 복귀
```

**표/그림 캡션 형식:**
- 표: `<표 장번호-순번> 표 제목` (예: `<표 3-1> 글로벌 반도체 시장 규모`)
- 그림: `[그림 장번호-순번] 그림 제목` (예: `[그림 3-1] 반도체 공급망 현황`)
- 단위: `(단위: 억 원, %)` → 표 우측 상단
- 주석: `주: 내용` → 표/그림 바로 아래
- 출처: `자료: 기관명(연도), 자료명` → 주석 아래

### 레시피 7: 머리말/꼬리말 (본문 완성 후)

본문 작성이 끝난 후 필요시 추가:
```
[꼬리말 - 쪽번호]
1. ⚠ 반드시 쪽 메뉴 경로 사용 (툴바 불안정)
2. 쪽 메뉴 → 꼬리말 → "가운데 쪽 번호" 선택
3. ⚠ 본문 더블클릭으로 종료 (Escape 불가!)

[머리말]
1. 쪽 메뉴 → 머리말 → (모양 없음) 또는 쪽 번호 옵션
2. 텍스트 입력 → 본문 더블클릭으로 종료

[확인] 스타일 드롭다운이 "바탕글"으로 변경되면 본문 복귀 완료
```

### 레시피 8: 최종 검토 + 저장

```
1. Ctrl+Home → 문서 처음
2. 스크롤하며 구조/서식 확인 (screenshot 3~5회)
3. 누락 서식 보정
4. Ctrl+S → 저장
```

---

## 스타일 프리셋 (문서 유형별)

### 프리셋 A: 실전 보고서 (표준 번호 체계) ★

장/절/소절 구조 + □○-· 기호 체계. → 설정값 상세: CLAUDE.md 스타일 관리 "표준 스타일 설정값" 테이블 참조

### 프리셋 B: 간단 보고서 (개요 기반)

스타일 추가 없이 기존 개요 스타일 편집. → CLAUDE.md 스타일 관리 "스타일별 일반적 속성" 테이블 참조

### 프리셋 C: 공문서

개요 기반의 공문서 변형. → CLAUDE.md 스타일 관리 "스타일별 일반적 속성 > 공문서 변형" 테이블 참조

---

## 문서 유형별 온디맨드 흐름

### 유형 1: 실전 보고서 (표준 번호 체계) ★

```
본문 시작: 제목 입력 → 개요 1 스타일 부적합? → 그때 편집
    ↓
본문 계속: 커스텀 스타일(□, ○) 필요? → 그때 배치 생성 (프리셋 A)
    ↓
표 필요 시점: 캡션 → 표 생성 → 데이터 → 출처
    ↓
본문 완성 후: 꼬리말 쪽번호 추가
    ↓
검토 + 저장
```
→ 용지 설정: 기본값이면 건너뜀, 여백 변경 필요시만 F7

### 유형 2: 간단 보고서 (개요 기반)

```
Ctrl+3(개요1) → 제목 입력 → 스타일 부적합? → 그때 편집 (18pt/가운데)
    ↓
Ctrl+1(바탕글) → 본문 입력 → 바탕글 10pt? → 그때 11pt/170%로 편집
    ↓
저장
```
→ 대부분의 설정을 건너뛸 수 있음

### 유형 3: 표 중심 문서 (현황표, 집계표)

```
(용지: 표가 넓으면 F7에서 가로로 변경)
    ↓
type("<표 1-1> 제목") → 표 생성 → 헤더/데이터 입력 → Shift+Esc → 출처
    ↓
저장
```

---

## 참고: 고속 입력 패턴

### Ctrl+숫자 + type 반복 (기본 단위)
```
Ctrl+{a} → type("내용") → Enter → Ctrl+{b} → type("내용") → Enter → ...
({a}, {b} = F6 스타일 목록 순서)
```
→ 각 type()에 **한 단락 전체**를 넣어 속도 극대화 (문장 단위 분할 금지)

---

## 에러 처리

### 스타일 전환이 안 됨
- F6 다이얼로그가 열리지 않으면: 에디터 본문 클릭 → 포커스 확보 → 재시도
- 툴바 스타일 드롭다운으로 대체

### 텍스트가 엉뚱한 곳에 입력됨
- screenshot으로 커서 위치 확인
- 원하는 위치 직접 클릭 → 입력 재시도

### 표 삽입 후 커서가 표 안에 갇힘
- **Shift+Esc**: 표 안 어디서든 즉시 탈출 (권장)
- **⚠ 탈출 검증 필수**: screenshot으로 커서가 표 바깥인지 확인 → 미확인 시 본문 입력 금지
- 또는 표 아래 영역 직접 클릭

### 문서가 길어져 스크롤 필요
- Ctrl+End로 문서 끝으로 이동
- Ctrl+Home으로 문서 처음으로 이동
- 특정 위치: Ctrl+F → 텍스트 검색으로 점프

### 장 표지 Enter 횟수 조정
→ hdocs-page E절 "장 표지 생성 패턴" 참조. 줄간격/글자크기에 따라 횟수가 달라지므로 screenshot으로 위치 확인 후 조정.

---

## 저장 및 마무리

### 자동 저장
한컴독스 웹은 자동 저장을 지원하지만, 중요 작업 후 명시적 저장 권장:
```
computer(action="key", text="ctrl+s", tabId={탭ID})
```

### 다른 이름으로 저장
```
파일 메뉴 → 다른 이름으로 저장 → 파일명 입력 → 확인
```

### 다운로드 (사용자 확인 필요)
```
파일 메뉴 → 다운로드 → 형식 선택 (hwpx, pdf 등) → 확인
```

---

## 참조
- 다른 skill: hdocs-format, hdocs-page, hdocs-insert (탐색/스타일/표는 CLAUDE.md에 내장)
- CLAUDE.md 오케스트레이터: 공통 패턴 및 에러 처리
- 스타일 프리셋 상세: 위 "스타일 프리셋" 섹션
