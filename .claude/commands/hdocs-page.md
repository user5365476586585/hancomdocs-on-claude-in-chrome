# 한컴독스 페이지 설정 (/hdocs-page)

한컴독스 웹 에디터의 페이지 레이아웃 관련 설정을 담당하는 skill.
편집 용지, 머리말/꼬리말, 쪽번호, 쪽 나누기, 다단 등을 제어한다.

사용자 요청: $ARGUMENTS

---

## 실행 전 절차

1. **에디터 탭 확인**: `tabs_context_mcp` → 한컴독스 에디터 탭 식별
2. **기존 다이얼로그 닫기**: Escape

---

## A. 편집 용지 (F7)

### 다이얼로그 열기
```
computer(action="key", text="F7", tabId={탭ID})
```
또는 메뉴: 쪽 → 편집 용지

### 설정 항목

**용지 종류:**
- 사용자 정의, A4, B5, Letter 등
- `find`로 용지 종류 드롭다운 찾기 → 선택

**용지 방향:**
- 세로 / 가로
- `find(query="세로")` 또는 `find(query="가로")` → 클릭

**여백 설정:**
- 위쪽, 아래쪽, 왼쪽, 오른쪽, 머리말, 꼬리말, 제본
- 각 입력 필드 찾기 → 값 입력
```
find(query="위쪽 여백", tabId={탭ID}) → triple_click → type("20")
find(query="아래쪽 여백", tabId={탭ID}) → triple_click → type("15")
find(query="왼쪽 여백", tabId={탭ID}) → triple_click → type("30")
find(query="오른쪽 여백", tabId={탭ID}) → triple_click → type("30")
```

**공문서 기본 여백 (참고):**
| 여백 | 값 (mm) |
|------|---------|
| 위쪽 | 20 |
| 아래쪽 | 15 |
| 왼쪽 | 30 |
| 오른쪽 | 30 |
| 머리말 | 15 |
| 꼬리말 | 15 |

### 절차
1. F7로 다이얼로그 열기
2. 용지 종류 선택 (보통 A4)
3. 용지 방향 선택
4. 각 여백 값 입력
5. 확인 클릭

---

## B. 머리말 (Header)

### 머리말 삽입/편집
1. 메뉴: 쪽 → 머리말 → 하위 메뉴 선택
   ```
   find(query="쪽 메뉴", tabId={탭ID}) → left_click
   find(query="머리말", tabId={탭ID}) → left_click (hover하면 하위 메뉴 표시)
   ```
2. **하위 메뉴 구조:**
   - **(모양 없음)**: 빈 머리말 생성 → 직접 텍스트 입력
   - **왼쪽 쪽 번호**: 왼쪽 정렬 쪽 번호 자동 삽입
   - **가운데 쪽 번호**: 가운데 정렬 쪽 번호 자동 삽입
   - **오른쪽 쪽 번호**: 오른쪽 정렬 쪽 번호 자동 삽입
3. 머리말 편집 모드 진입 (스타일 드롭다운이 "머리말"로 변경됨, 글자크기 9.0pt, 줄간격 150)
4. 머리말 영역에 텍스트 입력:
   ```
   computer(action="type", text="머리말 내용", tabId={탭ID})
   ```
5. **⚠ 머리말 편집 종료 (핵심):**
   - **본문 영역 더블클릭 필수** (단일 클릭으로는 빠져나올 수 없음!)
   - Escape 키도 머리말 모드를 종료하지 않음
   - 스타일 드롭다운이 "바탕글" 등으로 변경되면 본문 복귀 확인
   ```
   computer(action="double_click", coordinate=[본문영역좌표], tabId={탭ID})
   ```

### 머리말 삭제/변경
- 쪽 → 머리말 → 다른 옵션 선택하면 기존 머리말이 교체됨
- "(모양 없음)" 재선택 시 기존 내용 리셋 주의

---

## C. 꼬리말 (Footer)

### 꼬리말 삽입/편집
1. **⚠ 반드시 쪽 메뉴 경로 사용** (툴바 꼬리말 드롭다운은 편집 모드 진입이 불안정):
   ```
   find(query="쪽 메뉴", tabId={탭ID}) → left_click
   find(query="꼬리말", tabId={탭ID}) → hover (하위 메뉴 표시)
   ```
2. **하위 메뉴 구조** (머리말과 동일):
   - **(모양 없음)**: 빈 꼬리말 생성 → 직접 텍스트 입력
   - **왼쪽 쪽 번호**: 왼쪽 정렬 쪽 번호 자동 삽입
   - **가운데 쪽 번호**: 가운데 정렬 쪽 번호 자동 삽입
   - **오른쪽 쪽 번호**: 오른쪽 정렬 쪽 번호 자동 삽입
3. 꼬리말 편집 모드 진입 확인:
   - **스타일 드롭다운이 "머리말"로 변경됨** (꼬리말도 "머리말" 스타일 표시 — HWP 특성)
   - 글자크기 9.0pt, 줄간격 150
   - 페이지 하단에 "- 꼬리말(양 쪽) -" 구분선 표시
4. 텍스트 입력:
   ```
   computer(action="type", text="꼬리말 내용", tabId={탭ID})
   ```
5. **⚠ 편집 종료: 본문 영역 더블클릭 필수** (머리말과 동일)
   ```
   computer(action="double_click", coordinate=[본문영역좌표], tabId={탭ID})
   ```
   - 스타일 드롭다운이 "바탕글" 등으로 변경되면 본문 복귀 확인

---

## D. 쪽 번호

### 쪽 번호 삽입
보통 머리말이나 꼬리말 내에서 쪽 번호를 삽입:

1. 머리말 또는 꼬리말 편집 모드 진입
2. 메뉴: 쪽 → 새 번호로 시작 (번호 매기기 설정)
   ```
   find(query="쪽 메뉴", tabId={탭ID}) → left_click
   find(query="새 번호로 시작", tabId={탭ID}) → left_click
   ```
3. 시작 번호, 번호 형식 등 설정
4. 확인

### 쪽 번호 필드 삽입
꼬리말 내에서:
```
입력 메뉴 → 필드 입력 → 쪽 번호 관련 필드
또는: Ctrl+K+E → 필드 선택
```

---

## E. 쪽 나누기 / 단 나누기

### 쪽 나누기 (새 페이지)
```
computer(action="key", text="ctrl+Enter", tabId={탭ID})
```

### 단 나누기
```
computer(action="key", text="ctrl+shift+Enter", tabId={탭ID})
```

### 다단 설정 나누기
```
computer(action="key", text="ctrl+alt+Enter", tabId={탭ID})
```

### 장 표지 생성 패턴 ★ 검증 완료
```
1. Ctrl+Enter (새 페이지)
2. Enter × 10~12회 (페이지 중앙부로)
3. 가운데 정렬 + 글자크기 20pt + Ctrl+B
4. type("제N장") → Enter × 2
5. type("장 제목")
6. Ctrl+Enter (다음 페이지 = 본문 시작)
```
→ Enter 횟수는 줄간격에 따라 조정 (screenshot으로 확인)

---

## F. 다단 설정

1. 메뉴: 쪽 → 단
   ```
   find(query="쪽 메뉴", tabId={탭ID}) → left_click
   find(query="단", tabId={탭ID}) → left_click  ← "다단설정나누기" 가 아닌 "단" 설정
   ```
2. 다단 다이얼로그:
   - 단 수 설정
   - 단 간격 설정
   - 구분선 설정
3. 확인

---

## G. 현재 쪽만 감추기

```
computer(action="key", text="alt+n", tabId={탭ID})
→ wait(0.3)
→ computer(action="key", text="s", tabId={탭ID})
```
또는 메뉴: 쪽 → 현재 쪽만 감추기

---

## 공문서 페이지 설정 참고

공문서에서 필요한 페이지 설정. **각 항목은 필요할 때 수행**한다:

```
[용지/여백 - 기본값과 다를 때만]
F7 → A4 세로, 여백: 위 20, 아래 15, 좌 30, 우 30, 머리말 15, 꼬리말 15

[머리말 - 기관명/로고 필요 시]
쪽 메뉴 → 머리말 → 텍스트 입력 → 본문 더블클릭

[꼬리말 - 쪽번호/연락처 필요 시, 본문 완성 후]
쪽 메뉴 → 꼬리말 → 가운데 쪽 번호 → 본문 더블클릭
```

---

## 에러 처리

### F7 다이얼로그가 안 열림
- 에디터 본문 클릭 → 포커스 확보 → F7 재시도
- 메뉴 경로로 대체: 쪽 → 편집 용지

### 머리말/꼬리말 편집 모드 진입 안 됨
- **툴바 드롭다운 대신 쪽 메뉴 경로 사용** (쪽 → 꼬리말 → hover → 하위 메뉴)
- 툴바 꼬리말 버튼은 꼬리말을 생성하지만 편집 모드에 진입하지 않는 경우 있음
- 꼬리말 편집 모드 확인: 스타일 드롭다운 "머리말" (꼬리말도 동일 표시), 글자크기 9.0pt
- 본문 영역에 각주가 있으면 더블클릭 시 각주 모드로 진입될 수 있음 → 본문 중앙부 더블클릭 권장
- screenshot으로 현재 상태 확인

### 여백 값 입력이 안 됨
- 입력 필드를 triple_click으로 전체 선택 후 덮어쓰기
- read_page로 다이얼로그 내 요소 확인

---

## 참조
- 편집 용지: `format/setting_paper/setting_paper.htm`
- 쪽 나누기: `format/break/page_break.htm`
- 머리말/꼬리말: `insert/header_footer.htm`
- 도움말 URL 목록: `references/hdocs-help-urls.md`
