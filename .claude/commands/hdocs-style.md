# 한컴독스 스타일 적용 (/hdocs-style)

한컴독스 웹 에디터의 F6 스타일 다이얼로그를 통한 스타일 적용/관리 skill.
공문서 작성에서 개요(제목) 레벨 설정, 본문 스타일 등에 핵심적으로 사용된다.

사용자 요청: $ARGUMENTS

---

## 실행 전 절차

1. **에디터 탭 확인**: `tabs_context_mcp` → 한컴독스 에디터 탭 식별
2. **기존 다이얼로그 닫기**: 열린 다이얼로그가 있으면 `Escape`

---

## 스타일 동적 파악 (필요할 때 수행)

**스타일은 문서마다 정의가 다르다.** 하드코딩된 스타일 목록에 의존하지 말고,
스타일을 적용/편집해야 할 때 실제 스타일을 파악한다.

### ★ 기존 스타일 존중 원칙
- **기존 문서에 이미 잘 정의된 스타일은 오버라이드하지 않고 그대로 사용**
- 스타일 편집이 필요하면 **사용자 확인 후** 수행 (무단 변경 시 기존 레이아웃 파괴)
- **우선순위**: 기존 스타일 사용 > 기존 스타일 편집(확인 후) > 새 스타일 생성

### 언제 파악하는가
- **스타일을 처음 적용할 때**: 어떤 스타일이 있고 속성이 적합한지 확인
- **커스텀 스타일 추가가 필요할 때**: 기존 목록과 매핑 순서 확인
- **사용자가 스타일 목록을 요청할 때**
- ★ 사전에 일괄 파악하지 않음 — 필요한 시점에 필요한 스타일만 확인

### 파악 절차
1. **F6 키로 스타일 다이얼로그 열기**:
   ```
   computer(action="key", text="F6", tabId={탭ID})
   ```
2. **스타일 목록 읽기**:
   ```
   read_page(tabId={탭ID}, filter="all") → listbox 내 option 항목 확인
   ```
3. **필요한 스타일 속성 확인**:
   - 해당 스타일 클릭 → 우측 정보(크기, 줄간격, 정렬 등) 확인
   - 부적합하면 그 자리에서 "설정..." 버튼으로 편집
4. **Escape로 닫기** (변경 없으면)

---

## 한글 보고서 표준 스타일 체계 (★ 핵심 참조)

### 번호/기호 계층 구조

한글(HWP) 기반 보고서에서 가장 널리 쓰이는 계층적 번호/기호 체계.
실전 보고서 대부분이 이 구조를 따르며, 각 수준은 **독립 스타일**로 정의된다:

```
제N장 ○○○             ← 장 (20pt, 볼드)
  N.1 ○○○             ← 절 (15pt, 볼드)
    N.1.1 ○○○         ← 소절 (13pt, 볼드)
      □ 대주제           ← □ (13pt, 내어쓰기)
        ○ 본문 내용       ← ○ 내용1 (12pt, 왼여백10)
          - 세부 내용     ← - 내용2 (12pt, 왼여백24)
            · 상세 내용   ← · 내용3 (11pt, 왼여백34)
          ※ 참고/주의     ← ※ 내용4 (11pt)
      가. 한글 번호       ← 가. (12pt, 내어쓰기)
```

### 표준 스타일 설정값 (실전 보고서 기준)

**본문 계층 스타일:**

| 스타일명 | 크기 | 줄간격 | 왼쪽여백 | 첫줄 | 정렬 | 글머리표 |
|----------|------|--------|----------|------|------|---------|
| 장 | 20pt | 140% | 10pt | 보통 | 양쪽 | 없음 |
| 1.1 | 15pt | 140% | 0pt | 보통 | 양쪽 | 없음 |
| 1.1.1 | 13pt | 140% | 0pt | 보통 | 양쪽 | 없음 |
| □ | 13pt | 140% | 5pt | 내어쓰기 | 양쪽 | 없음 |
| ○ 내용1 | 12pt | 140% | 10pt | 보통 | 양쪽 | 글머리표 |
| - 내용2 | 12pt | 140% | 24pt | 보통 | 양쪽 | 글머리표 |
| · 내용3 | 11pt | 140% | 34pt | 보통 | 양쪽 | 글머리표 |
| ※ 내용4 | 11pt | 140% | 24pt | 보통 | 양쪽 | 없음 |
| 가. | 12pt | 140% | 10pt | 내어쓰기 | 양쪽 | 없음 |

**표/그림 관련 스타일:**

| 스타일명 | 크기 | 줄간격 | 정렬 | 용도 |
|----------|------|--------|------|------|
| 표 제목 | 11pt | 160% | 가운데 | `<표 N-M> 제목` |
| 그림 제목 | 11pt | 160% | 가운데 | `[그림 N-M] 제목` |
| 표내용(양쪽정렬) | 10pt | 130% | 양쪽 | 표 셀 본문 |
| 표내용 ◦ | 10pt | 130% | 양쪽 | 표 셀 글머리표 |
| 표.그림의 자료및주 | 9pt | 130% | 양쪽 | 출처/주석 |
| 표,그림의 단위 | 9pt | 130% | 오른쪽 | 단위 표기 |

**기타 스타일:**

| 스타일명 | 용도 | 비고 |
|----------|------|------|
| 바탕글 | 기본 본문 | 10pt, 줄간격 160% |
| 각주 | 각주 텍스트 | 9pt |
| 목차-장 | 목차 장 항목 | |
| 목차-1.1 | 목차 절 항목 | |
| 간지-편&장 | 간지 페이지 | 별도 쪽 |
| 꼬리말 | 꼬리말 | 9pt |

### 기본 제공 스타일 (개요 기반, 간단한 문서)

커스텀 스타일이 없는 기본 문서:

| 스타일명 | 용도 | 비고 |
|----------|------|------|
| 바탕글 | 기본 본문 | 기본값 10pt |
| 본문 | 본문 텍스트 | |
| 개요 1~10 | 제목 레벨 | |
| 머리말/각주/미주/메모 | 특수 영역 | |
| 차례 제목/차례 1~3 | 차례 | |
| 캡션 | 캡션 | |

### 커스텀 스타일 생성 워크플로우 (테스트 검증 완료)

위 표준 스타일이 문서에 없는 경우, 2단계로 생성:

**1단계: 스타일 이름 생성 (추가 버튼)**
```
1. F6 → 스타일 다이얼로그
2. 추가(+) 버튼 클릭
3. "스타일 추가하기" 다이얼로그:
   - 스타일 이름 입력 (예: "1.1", "□", "○ 내용1" 등)
   - 다음 스타일: 동일 스타일 또는 바탕글 지정
   - ⚠ 이 다이얼로그에는 글자/문단 설정 없음!
4. 확인 → F6 메인으로 복귀 (새 스타일이 목록에 추가됨)
```

**2단계: 스타일 속성 설정 ("설정..." 버튼, JS 클릭 필수)**
```
5. F6 메인에서 방금 추가한 스타일 클릭
6. JS로 "글자 모양 설정..." 클릭 → 글꼴, 크기, 진하게 등 → 확인
7. JS로 "문단 모양 설정..." 클릭 → 줄간격, 정렬, 여백 등 → 확인
8. 필요시 JS로 "글머리표/문단번호 설정..." 클릭 → 기호 종류 → 확인
9. 다음 스타일도 같은 방식으로 반복 (F6에서 다른 스타일 선택 → 설정...)
10. 모든 스타일 완료 후 확인 클릭 → F6 닫힘
```

**⚠ "설정..." 버튼 JS 클릭**: → D절의 JS 코드 참조 (btns[0]=문단, btns[1]=글자, btns[2]=글머리표)

**첫줄 설정 (들여쓰기/내어쓰기):**
- **보통**: 들여쓰기 없음 (대부분의 스타일)
- **들여쓰기**: 첫 줄만 안으로 들어감 (본문 단락용)
- **내어쓰기**: 첫 줄 제외 나머지가 안으로 들어감 (□, 가. 등 번호 스타일용)
  - 내어쓰기를 사용하면 "□ 긴 제목이 두 줄에 걸쳐질 때 두 번째 줄이 정렬됨"

---

## 핵심 기능

### A. 스타일 적용 (기본 워크플로우)

현재 커서 위치 또는 선택된 텍스트에 스타일을 적용한다.

**절차:**
1. 텍스트 선택 또는 커서 위치 확인
2. F6 키로 스타일 다이얼로그 열기:
   ```
   computer(action="key", text="F6", tabId={탭ID})
   ```
3. 다이얼로그 열림 확인 (screenshot 또는 find):
   ```
   find(query="스타일 목록", tabId={탭ID})
   또는
   find(query="스타일", tabId={탭ID})  ← 다이얼로그 제목
   ```
4. 원하는 스타일 찾기 및 클릭:
   ```
   find(query="{스타일명}", tabId={탭ID})
   예: find(query="개요 1"), find(query="본문"), find(query="바탕글")
   ```
   - 스타일 목록은 listbox 형태. 해당 option 요소를 클릭
   - find로 찾기 어려우면 `read_page`로 다이얼로그 내부 구조 확인 후 해당 요소 클릭
5. "확인" 버튼 클릭:
   ```
   find(query="확인", tabId={탭ID}) → left_click
   ```

**간편 방법 1 - Ctrl+숫자 단축키 (가장 빠름):**
스타일 목록 순서대로 Ctrl+1~9로 즉시 적용:
```
Ctrl+1 = 바탕글 (1번째)
Ctrl+2 = 본문 (2번째)
Ctrl+3 = 개요 1 (3번째)
Ctrl+4 = 개요 2 (4번째)
... Ctrl+9 = 개요 7 (9번째)
```
- **주의**: 문서마다 스타일 목록 순서가 다를 수 있음 → F6으로 먼저 순서 확인
- **주의**: 가끔 여러 번 눌러야 적용되는 에디터 quirk 있음. 적용 안 되면 2~3회 반복 시도
- 10번째 이후 스타일은 이 단축키로 접근 불가 → F6 또는 드롭다운 사용

**간편 방법 2 - 툴바 스타일 드롭다운:**
1. 서식 도구상자의 스타일 드롭다운 찾기:
   ```
   find(query="스타일 드롭다운", tabId={탭ID})
   또는
   find(query="바탕글", tabId={탭ID})  ← 현재 스타일명이 표시됨
   ```
2. 드롭다운 클릭 → 목록에서 원하는 스타일 선택
3. **주의**: 드롭다운도 가끔 여러 번 클릭해야 적용되는 경우 있음

### B. 현재 스타일 확인

현재 커서 위치의 적용된 스타일 확인:

**방법 1 - 툴바:**
```
find(query="스타일 드롭다운", tabId={탭ID})
→ 현재 표시된 값이 적용 중인 스타일명
```

**방법 2 - F6 다이얼로그:**
1. F6으로 다이얼로그 열기
2. 스타일 목록에서 강조(선택) 표시된 항목이 현재 스타일
3. Escape로 닫기 (변경 없이)

### C. 스타일 추가 (새 스타일 만들기)

1. F6으로 스타일 다이얼로그 열기
2. 추가(+) 버튼 찾기 및 클릭:
   ```
   find(query="추가", tabId={탭ID})  ← 또는 "스타일 추가하기" 버튼
   ```
3. **"스타일 추가하기" 다이얼로그** (이름만 설정):
   - 스타일 이름 입력
   - 영문 이름 입력 (선택)
   - 다음 문단에 적용할 스타일 선택
   - **⚠ 이 다이얼로그에는 글자/문단 모양 설정이 없음**
4. 확인 클릭 → F6 메인 다이얼로그로 복귀
5. **속성 설정은 F6 메인 다이얼로그의 "설정..." 버튼으로 진행** (아래 D절 참조)

### D. 스타일 속성 편집 (★ 핵심 - "설정..." 버튼 사용)

**⚠ 중요: 편집(연필) 버튼 ≠ 속성 편집**
- **편집(연필) 버튼**: 스타일 **이름**과 "다음 문단에 적용할 스타일"만 변경 가능
- **속성 편집(글꼴/크기/줄간격 등)**: F6 메인 다이얼로그 우측의 **"설정..." 버튼** 사용

#### "설정..." 버튼 클릭 방법 (⚠ JavaScript 필수)

F6 다이얼로그 우측에 3개의 "설정..." 버튼이 있음:
- **문단 모양 설정...**: 정렬, 줄간격, 여백, 첫줄(들여쓰기/내어쓰기) 등
- **글자 모양 설정...**: 글꼴, 크기, 진하게, 기울임, 장평, 자간 등
- **글머리표/문단번호 설정...**: 글머리표 종류 등

**⚠ 이 버튼들은 `find()`나 좌표 클릭으로 접근 불가!**
`DIV[role="button"] > A > SPAN` 구조로, JavaScript DOM 클릭만 작동함:

```javascript
// 1단계: "설정..." 버튼 찾기
const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);
const buttons = [];
while (walker.nextNode()) {
  if (walker.currentNode.textContent.trim() === '설정...') {
    const btn = walker.currentNode.parentElement.closest('[role="button"]');
    if (btn) buttons.push(btn);
  }
}
// buttons[0] = 문단 모양 설정
// buttons[1] = 글자 모양 설정
// buttons[2] = 글머리표/문단번호 설정

// 2단계: 클릭 (예: 글자 모양 설정)
buttons[1].querySelector('a').click();
```

#### 전체 속성 편집 워크플로우

```
1. F6 → 스타일 다이얼로그 열기
2. 편집할 스타일 클릭 (스타일 목록에서 선택)
3. [글자 모양 변경 시]:
   → JS로 "글자 모양 설정..." 버튼 클릭 (buttons[1])
   → 글자 모양 다이얼로그에서 글꼴/크기/진하게 등 설정
   → 확인 → F6 메인으로 복귀
4. [문단 모양 변경 시]:
   → JS로 "문단 모양 설정..." 버튼 클릭 (buttons[0])
   → 문단 모양 다이얼로그에서 줄간격/정렬/여백 등 설정
   → 확인 → F6 메인으로 복귀
5. [글머리표 변경 시]:
   → JS로 "글머리표/문단번호 설정..." 버튼 클릭 (buttons[2])
   → 설정 → 확인 → F6 메인으로 복귀
6. 다른 스타일도 동일하게 반복 (F6 메인에서 다른 스타일 클릭 → 설정...)
7. 최종 확인 클릭 → F6 닫힘
   ⚠ 확인 클릭 시 마지막 선택한 스타일이 커서 위치에 적용됨!
   → 의도치 않은 스타일 적용 시 Ctrl+Z로 즉시 취소
```

### E. 스타일 이름 편집 (편집/연필 버튼)

편집(연필) 버튼은 스타일 이름 변경에만 사용:
1. F6 → 편집할 스타일 선택
2. 편집(연필) 버튼 클릭:
   ```
   find(query="편집", tabId={탭ID})
   ```
3. "스타일 편집하기" 다이얼로그에서:
   - 스타일 이름 변경
   - 다음 문단에 적용할 스타일 변경
   - **⚠ 글자/문단 모양 설정 없음!**
4. 확인 클릭

### F. 스타일 삭제

1. F6으로 스타일 다이얼로그 열기
2. 삭제할 스타일 선택
3. 삭제(X) 버튼 클릭:
   ```
   find(query="삭제", tabId={탭ID})
   ```
4. 확인 다이얼로그에서 확인
5. **주의**: 기본 스타일(바탕글 등)은 삭제 불가

---

## 스타일별 일반적 속성

### 간단한 문서 (개요 기반, 편집 후 사용)

| 스타일 | 크기 | 줄간격 | 정렬 | 비고 |
|--------|------|--------|------|------|
| 개요 1 | 18pt | 160% | 가운데 | 진하게 |
| 개요 2 | 14pt | 160% | 양쪽 | 진하게 |
| 개요 3 | 12pt | 160% | 양쪽 | 진하게 |
| 바탕글 | 11pt | 170% | 양쪽 | |

**공문서 변형** (개요 기반, 공문서 규격에 맞춘 크기):

| 스타일 | 크기 | 줄간격 | 정렬 | 비고 |
|--------|------|--------|------|------|
| 개요 1 | 16pt | 160% | 가운데 | 진하게 |
| 개요 2 | 13pt | 160% | 양쪽 | 진하게 |
| 바탕글 | 12pt | 160% | 양쪽 | |

### 실전 보고서 (커스텀 스타일, 위 "표준 스타일 체계" 참조)

실전 보고서는 □, ○, -, · 기호 체계 + 절번호(1.1, 1.1.1) + 표/그림 캡션 스타일이 필요.
위 "한글 보고서 표준 스타일 체계" 섹션의 설정값 테이블 참조.

---

## 다이얼로그 내부 구조 참고

### F6 스타일 다이얼로그 구성
- **좌측**: 스타일 목록 (listbox) - 스타일명 나열, 클릭으로 선택
- **우측 상단**: 선택한 스타일의 상세 정보 (읽기 전용 표시)
  - 문단 모양: 왼쪽여백, 오른쪽여백, 줄간격, 다음스타일, 첫줄, 정렬방식
  - 글자 모양: 글꼴, 크기, 장평, 자간
  - 글머리표/문단번호: 종류
- **우측 "설정..." 버튼 3개** (⚠ JS 클릭 필수):
  - 문단 모양 설정... (buttons[0])
  - 글자 모양 설정... (buttons[1])
  - 글머리표/문단번호 설정... (buttons[2])
- **하단 버튼**: 추가(+), 편집(연필), 삭제(X), 확인

### "스타일 추가하기" 다이얼로그 (추가 버튼 클릭 시)
- 스타일 이름 입력 필드
- 영문 이름 입력 필드
- 다음 문단에 적용할 스타일 드롭다운
- **⚠ 글자/문단 모양 설정 필드 없음** → 이름만 지정하고 확인, 속성은 F6 메인의 "설정..."으로

### "스타일 편집하기" 다이얼로그 (편집/연필 버튼 클릭 시)
- 스타일 이름 변경 필드
- 영문 이름 변경 필드
- 다음 문단에 적용할 스타일 드롭다운
- **⚠ 글자/문단 모양 설정 필드 없음** → 이름만 변경 가능

### 글자 모양 다이얼로그 ("글자 모양 설정..." 클릭 시)
- 기준 크기 (pt) 입력 필드
- 글꼴 선택 (한글/영문/한자)
- 진하게/기울임/밑줄/취소선 등 속성 버튼
- 장평, 자간 입력 필드
- 글자색, 음영색

### 문단 모양 다이얼로그 ("문단 모양 설정..." 클릭 시)
- 줄 간격 (%) 입력 필드
- 정렬: 양쪽/왼쪽/가운데/오른쪽
- 왼쪽/오른쪽 여백
- 첫줄: 보통/들여쓰기/내어쓰기
- 문단 위/아래 간격

**⚠ 줄간격/여백은 반드시 확인 — 글자 크기만 바꾸면 문서가 빈약해 보임:**
```
[줄간격 기준]
제목(개요1~3): 140~160%   본문(바탕글): 160~170%
표 내용: 130%              머리말/꼬리말: 150%

[왼쪽여백 = 계층 표현]
0pt=최상위  5pt=대주제  10pt=본문Lv1  24pt=본문Lv2  34pt=본문Lv3
→ 왼쪽여백 없으면 계층 구분 불가

[문단 간격] 제목: 위 10~20pt (섹션 구분감) / 본문: 0pt
[첫줄] 보통=대부분 / 내어쓰기=□,가. 등 (둘째 줄 정렬) / 들여쓰기=장문 본문
```

### 글머리표/문단번호 다이얼로그 ("글머리표/문단번호 설정..." 클릭 시) ★

2개 탭으로 구성:
- **글머리표 탭**: "없음" + 17개 프리셋 (menuitem 클릭으로 선택)
  - 기호 종류: ●, ○, ■, □, ◆, ◇, ▶, ▷, ★, ☆, -, · 등
- **문단 번호 탭**: 12개 프리셋 번호 체계
  - 1./2./3..., 가./나./다..., (1)/(2)/(3)..., ①②③..., 1.1/1.1.1... 등
  - 시작 번호 방식: "앞 번호에 이어" / "이전 번호에 이어" / "새 번호 목록 시작"
  - 1수준 시작 번호 입력 필드
- 하단: 확인, 취소

**활용 패턴:**
- 제목 스타일(개요1~3): 글머리표 "없음" (번호는 직접 타이핑이 더 유연)
- 본문 스타일(○ 내용1 등): 해당 기호 프리셋 선택 → 자동 글머리표
- 번호 목록 스타일(가. 등): 문단 번호 탭에서 적절한 형식 선택

### 요소를 못 찾을 경우
```
read_page(tabId={탭ID}, filter="interactive") → 전체 인터랙티브 요소 확인
```
"설정..." 버튼은 `find()`나 `read_page()`에 표시되지 않을 수 있음 → JS 필수

---

## G. 배치 스타일 생성 (★ 실전 보고서용)

여러 커스텀 스타일을 효율적으로 생성하는 2패스 워크플로우. ★ 검증 완료

### 2패스 분리 방식 (권장)

F6 다이얼로그를 유지하면서 이름 등록과 속성 설정을 분리하여 효율 극대화:

```
[1패스: 이름 일괄 등록]
1. F6 → 스타일 다이얼로그 열기
2. 추가(+) → "1.1" 입력 → 확인 → F6 자동 복귀
3. 추가(+) → "□" 입력 → 확인 → F6 자동 복귀
4. 추가(+) → "○ 내용1" 입력 → 확인 → F6 자동 복귀
5. 추가(+) → "- 내용2" 입력 → 확인 → F6 자동 복귀
... 필요한 스타일 모두 등록
```

```
[2패스: 속성 일괄 설정 - JS 클릭 필수]
6. "1.1" 클릭 → JS 글자모양(15pt, 볼드) → 확인 → JS 문단모양(140%, 양쪽) → 확인
7. "□" 클릭 → JS 글자모양(13pt, 볼드) → 확인 → JS 문단모양(왼여백5, 내어쓰기) → 확인
8. "○ 내용1" 클릭 → JS 글자모양(12pt) → 확인 → JS 문단모양(왼여백10) → 확인
9. "- 내용2" 클릭 → JS 글자모양(12pt) → 확인 → JS 문단모양(왼여백24) → 확인
... 모든 스타일 속성 설정
10. 최종 확인 → F6 닫힘
```

### ⚠ 주의사항
- 추가(+) → 확인 시 F6 메인으로 **자동 복귀**됨 (F6을 다시 열 필요 없음)
- 1패스 완료 후 2패스에서 "설정..." 버튼은 반드시 **JS 클릭** 사용
- 새 스타일 추가 시 **Ctrl+숫자 매핑 순서가 변동**됨 (아래 H절 참조)
- "다음 스타일" 체이닝 활용: 장→1.1, □→○ 내용1 등으로 지정하면 Enter 시 자동 전환

### 프리셋별 배치 생성 목록

**실전 보고서 (9개 스타일):**
```
추가 순서: 1.1 → 1.1.1 → □ → ○ 내용1 → - 내용2 → · 내용3 → ※ 내용4 → 표 제목 → 출처
```
→ 속성 설정값은 hdocs-write.md "스타일 프리셋" 참조

---

## H. Ctrl+숫자 매핑 자동 감지 (★ 검증 완료)

스타일 목록 순서가 곧 Ctrl+숫자 매핑이므로, F6에서 JS로 자동 파악 가능.

### 감지 방법 (F6 열린 상태에서)

```javascript
// F6 다이얼로그 열린 상태에서 실행
const dialog = document.querySelector('.modal_dialog');
const anchors = dialog.querySelectorAll('a');
const styles = Array.from(anchors)
  .map(a => a.textContent.trim())
  .filter(t => t.length > 0 && t !== '설정...');
const mapping = styles.map((name, i) =>
  `${i+1}. ${name} → ${i < 9 ? 'Ctrl+'+(i+1) : (i === 9 ? 'Ctrl+0' : 'N/A')}`
);
mapping.join('\n');
```

### 매핑 규칙
- **1~9번째** 스타일: `Ctrl+1` ~ `Ctrl+9`
- **10번째** 스타일: `Ctrl+0`
- **11번째 이후**: Ctrl+숫자로 접근 불가 → F6 또는 드롭다운 사용
- 커스텀 스타일 추가 시 **가나다순/추가순에 따라 순서 변동** → 매번 확인 필요

### 기본 문서 (커스텀 없음) 매핑 예시
```
Ctrl+1 = 바탕글
Ctrl+2 = 본문
Ctrl+3 = 개요 1
Ctrl+4 = 개요 2
...
Ctrl+9 = 개요 7
Ctrl+0 = 개요 8
```

### 활용 패턴
```
1. 스타일을 처음 사용할 때 F6 열기
2. JS로 매핑 테이블 추출 → Escape
3. 이후 Ctrl+숫자로 본문 작성
→ 세션 내에서 스타일 추가/삭제가 없으면 한 번만 확인
```

---

## I. 스타일 갭 분석 (온디맨드)

커스텀 스타일이 다수 필요한 실전 보고서에서, 필요 스타일을 한꺼번에 파악하고 생성하는 워크플로우.
**간단한 문서에서는 이 절차를 건너뛰고**, 스타일을 사용할 때마다 개별 확인/편집한다.

### 언제 사용하는가
- 사용자가 "보고서", "분석", "조사" 등 실전 보고서 키워드를 사용할 때
- □, ○, - 등 커스텀 스타일이 **5개 이상** 필요할 것으로 판단될 때
- 이 경우 개별 온디맨드보다 **일괄 생성이 더 효율적**

### 갭 분석 절차

```
1. F6 열기 → JS로 현재 스타일 목록 추출 (H절 코드 사용)
2. 필요 스타일 비교:
   [실전 보고서] 장, 1.1, 1.1.1, □, ○ 내용1, - 내용2, · 내용3, ※ 내용4, 표 제목, 출처
   [간단 보고서] 개요 1~3, 바탕글 (기본 제공 → 속성 편집만)
   [공문서]     개요 1~2, 바탕글 (기본 제공 → 속성 편집만)
3. 갭 = 필요한데 없는 스타일
4. 사용자에게 제안 → 승인 시 G절 배치 생성 실행
```

### 사용자 확인 의사결정 트리

```
[누락 스타일 있음]
→ "이 문서에 □, ○ 등 보고서 스타일이 없습니다. 자동 생성할까요?"
→ 승인 → G절 배치 스타일 생성
→ 거부 → 기존 개요 스타일로 대체 (아래 매핑 참조)

[스타일 있으나 속성 부적합]
→ "바탕글이 10pt인데 11pt로 변경할까요?" 등 제안
→ 승인 → D절 속성 편집

[스타일 존재 + 속성 적합]
→ 추가 작업 불필요
```

### 대체 스타일 매핑 (커스텀 생성 거부 시)

커스텀 스타일 없이 기존 개요 스타일로 대체하는 방법:

| 필요 스타일 | 대체 | 편집할 속성 |
|------------|------|-----------|
| 장 | 개요 1 | 18~20pt, 볼드, 가운데 |
| 1.1 | 개요 2 | 14~15pt, 볼드, 양쪽 |
| 1.1.1 | 개요 3 | 12~13pt, 볼드, 양쪽 |
| □ | 개요 4 | 13pt, 볼드, 왼여백 5pt |
| ○ 내용1~3 | 바탕글 | 11pt, 양쪽 (기호는 직접 입력) |
| 표/그림 제목 | (직접 서식) | 11pt, 가운데 |
| 출처 | (직접 서식) | 9pt |

⚠ 대체 매핑은 **기호(□, ○, -)가 스타일에 포함되지 않으므로** 본문에서 직접 타이핑해야 함.
커스텀 스타일 생성이 더 효율적임을 사용자에게 안내.

---

## 에러 처리

### F6 다이얼로그가 안 열림
1. 에디터 본문 클릭하여 포커스 확보
2. F6 재시도
3. 여전히 안 열리면: 메뉴바 "서식" → "스타일" 경로로 시도

### 스타일이 목록에 없음
- 스크롤 필요할 수 있음 → `scroll` 액션 또는 키보드 방향키로 탐색
- 정확한 스타일명 확인 (예: "개요1" vs "개요 1" 공백 차이)

### 스타일 적용이 안 됨
1. 텍스트가 선택되었는지 확인
2. 스타일 다이얼로그에서 "확인"을 클릭했는지 확인
3. 되돌리기(Ctrl+Z) 후 재시도

### F6 확인 후 의도치 않은 스타일 적용 ★
- **증상**: F6에서 스타일 속성 편집 후 "확인" 클릭 → 커서 위치에 마지막 선택 스타일이 적용됨
- **원인**: F6 "확인"은 스타일 저장 + 현재 커서에 선택 스타일 적용을 동시에 수행
- **대응**: Ctrl+Z로 즉시 취소 (스타일 정의 자체는 유지됨, 적용만 취소)

---

## 참조
- 공식 도움말: `format/style/style.htm`, `style(new).htm`, `style(edit).htm`, `style(erase).htm`
- 도움말 URL 목록: `references/hdocs-help-urls.md`
