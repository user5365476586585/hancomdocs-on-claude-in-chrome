# 한컴독스 개체 삽입 (/hdocs-insert)

한컴독스 웹 에디터에서 다양한 개체(도형, 그림, 수식, 문자표 등)를 삽입하는 skill.

사용자 요청: $ARGUMENTS

---

## 실행 전 절차

1. **에디터 탭 확인**: `tabs_context_mcp` → 한컴독스 에디터 탭 식별
2. **기존 다이얼로그 닫기**: Escape

---

## A. 도형 삽입

### 삽입 절차 (툴바 사용 — 권장)
1. 툴바 "도형" 버튼 클릭 → "그리기 개체" 도구 모음이 나타남:
   - 도형 종류 아이콘: 직사각형, 타원, 직선, 곡선, 호 등
   ```
   find(query="도형 toolbar button") → left_click  ← 또는 좌표로 클릭
   ```
2. 원하는 도형 종류 클릭:
   ```
   find(query="직사각형", tabId={탭ID}) → left_click
   find(query="타원", tabId={탭ID}) → left_click
   ```
3. 에디터 위에서 드래그하여 도형 크기 지정:
   ```
   computer(action="left_click_drag", start_coordinate=[x1,y1], coordinate=[x2,y2], tabId={탭ID})
   ```
4. 도형 생성 후 자동으로 선택 상태 (8개 파란색 핸들 표시)

### ⚠ 입력 메뉴 경로 주의
- 입력 메뉴 → "도형"은 하위 메뉴가 있으나, `find(query="도형")`이 "그림"으로 잘못 매핑될 수 있음
- **툴바 도형 버튼 사용이 더 안정적**

### 도형/개체 선택/해제 패턴 (글상자, 도형 공통)
- **Escape 1회**: 개체 내부 편집 → 개체 선택 모드 (핸들 표시)
- **Escape 2회**: 개체 선택 해제 → 본문 커서 복귀
- **Delete**: 선택 상태에서 개체 삭제
- **더블클릭**: 개체 내부 편집 모드 재진입 (글상자), 또는 개체 속성 다이얼로그 (도형)

### 도형 속성 변경
- 도형 선택 후 더블클릭 → 개체 속성 다이얼로그
- 또는: 도형 선택 → 서식 → 개체 속성

---

## B. 그림 삽입

### 단축키
```
computer(action="key", text="alt+n", tabId={탭ID})
→ wait(0.3)
→ computer(action="key", text="i", tabId={탭ID})
```

### 메뉴 경로
```
find(query="입력 메뉴", tabId={탭ID}) → left_click
find(query="그림", tabId={탭ID}) → left_click
```

### "그림 넣기" 다이얼로그 구조 ★ 검증 완료
- **● 장치** (기본): Choose File 버튼 → OS 네이티브 파일 선택
- **○ 웹 주소**: URL 입력 필드 활성화 → URL 직접 입력
- **☑ 글자처럼 취급** (기본 체크): 그림을 인라인으로 배치 (텍스트와 같은 줄)
- **□ 마우스로 크기 지정**: 체크 시 삽입 후 드래그로 크기 지정, 해제 시 원본 크기
- **넣기** / **취소** 버튼

### 삽입 방법별 절차

**방법 A: 웹 주소로 삽입 (★ 완전 자동화 가능)**
```
1. Alt+N → I → 그림 넣기 다이얼로그 열기
2. "웹 주소" 라디오 버튼 클릭:
   find(query="웹 주소 radio") → left_click
3. URL 입력 필드에 이미지 URL 입력:
   find(query="웹 주소 textbox") → left_click → type("https://example.com/image.png")
4. (선택) "글자처럼 취급" 체크 해제 → 자유 배치 가능
5. "넣기" 클릭:
   find(query="넣기") → left_click
```

**방법 B: 장치(파일) 삽입 (부분 자동화)**
```
1. Alt+N → I → 그림 넣기 다이얼로그 열기
2. "장치" 라디오 (기본 선택됨)
3. ⚠ "Choose File" 버튼 → OS 네이티브 다이얼로그 → 자동화 불가
   → 사용자에게 직접 파일 선택 안내
4. 파일 선택 후 "넣기" 클릭
```

**방법 C: upload_image 도구 활용 (MCP)**
```
1. Alt+N → I → 그림 넣기 다이얼로그 열기
2. "장치" 라디오 상태에서:
   upload_image(imageId="{이미지ID}", tabId={탭ID}, ref="{Choose File ref}")
3. "넣기" 클릭
```

### 그림 삽입 후 조작
- **크기 조정**: 그림 선택 → 핸들 드래그 또는 개체 속성 다이얼로그
- **위치 변경**: "글자처럼 취급" 해제 시 자유 이동 가능
- **선택 해제**: Escape 1회(선택 모드) → Escape 2회(본문 복귀)
- **삭제**: 선택 상태에서 Delete

### 그림 캡션 워크플로우 ★
```
1. 그림 삽입 완료 후 Escape 2회 → 본문 복귀
2. Enter (그림 아래 새 줄)
3. 그림 제목 스타일 적용 (Ctrl+숫자)
4. type("[그림 {장번호}-{순번}] {제목}") → Enter
5. 출처 스타일 적용 (Ctrl+숫자)
6. type("자료: {출처명}({연도}), {제목}") → Enter
```

---

## C. 차트 삽입

1. 입력 → 차트:
   ```
   find(query="입력 메뉴", tabId={탭ID}) → left_click
   find(query="차트", tabId={탭ID}) → left_click
   ```
2. 차트 편집기에서 데이터 입력 및 차트 유형 선택
3. 확인

---

## D. 글상자 삽입

### 단축키
```
computer(action="key", text="alt+n", tabId={탭ID})
→ wait(0.3)
→ computer(action="key", text="b", tabId={탭ID})
```

### 절차
1. Alt+N → B로 글상자 삽입 모드 활성화 (커서가 십자 모양으로 변경)
2. 에디터 본문 위에서 클릭 → 기본 크기 글상자 생성 (또는 드래그로 크기 지정)
3. 커서가 자동으로 글상자 내부에 위치 → 바로 텍스트 입력 가능:
   ```
   computer(action="type", text="글상자 내용", tabId={탭ID})
   ```

### 글상자 나가기/선택/삭제
- **Escape 1회**: 글상자 내부 편집 종료 → 개체 선택 모드 (8개 파란색 핸들 표시)
- **Escape 2회**: 개체 선택 해제 → 본문 커서 복귀
- **개체 선택 상태에서 Delete**: 글상자 삭제
- **글상자 더블클릭**: 다시 내부 텍스트 편집 모드 진입

---

## E. 수식 삽입

### ⚠ 수식 편집기 자동화 제한사항
수식 편집기는 WASM 캔버스 기반으로 렌더링되어 **부분적으로만 자동화 가능**:
- ✅ 수식 편집기 열기, 수식 코드 입력 가능
- ❌ 수식 편집기 내부 다이얼로그 버튼 클릭 불가 (캔버스 렌더링)
- ❌ "미리 보기" 버튼, 도구 모음 기호 버튼 클릭 불가
- ❌ 저장 확인 다이얼로그 ("넣기"/"나가기"/"취소") 클릭 불가
- **결론**: 수식 코드 입력까지는 자동화 가능하나, 삽입 완료는 사용자 수동 조작 필요

### 수식 편집기 열기
```
find(query="입력 메뉴", tabId={탭ID}) → left_click
find(query="수식", tabId={탭ID}) → left_click
```

### 수식 편집기 구조
- **제목**: "수식 편집"
- **상단 도구 모음** (2행): 수식 기호/구조 버튼 (분수, 루트, 시그마, 적분, lim, 행렬 등)
- **중앙 상단**: 미리보기 영역 (수식 렌더링 표시)
- **중앙 하단**: 텍스트 입력 영역 (HWP 수식 코드 입력)
- **하단 우측**: "미리 보기" 버튼
- **글꼴**: HancomEQN, 10pt
- **닫기**: X 버튼 (우상단) 또는 Escape → 확인 다이얼로그

### 수식 코드 입력 (자동화 가능 부분)
1. 수식 편집기 열기 (입력 → 수식)
2. 하단 입력 영역 클릭
3. HWP 수식 문법으로 코드 입력:
   ```
   computer(action="type", text="x = {-b +- sqrt {b^2 - 4ac}} over {2a}", tabId={탭ID})
   ```

### HWP 수식 문법 (주요 키워드)
- `over`: 분수 (a over b = a/b)
- `sqrt`: 제곱근
- `^`: 위 첨자
- `_`: 아래 첨자
- `+-`: ±
- `{...}`: 그룹
- `sum`, `int`, `lim`: 합, 적분, 극한

### 사용자 수동 조작 안내
수식 코드 입력 후 사용자에게 안내:
- Escape → "넣기" 버튼 클릭 (수식 삽입)
- 또는 Escape → "나가기" 버튼 클릭 (삽입 취소)

---

## F. 문자표 (특수문자)

### 단축키
```
computer(action="key", text="ctrl+F10", tabId={탭ID})
```

### 다이얼로그 구조
- **문자 영역 리스트** (좌측): 일반 문장 부호, 기호1, 기호2, 통화 기호, 기호3 등
- **문자 격자** (중앙): 선택한 영역의 문자들
- **최근 사용한 문자** (하단)
- **입력 문자** 필드 (하단): 삽입할 문자 확인/편집
- **넣기** 버튼: 입력 문자 필드의 문자를 문서에 삽입

### 절차 (권장: 직접 입력 방법)
1. 문자표 다이얼로그 열기: `computer(action="key", text="ctrl+F10")`
2. 문자 영역 선택 (필요시):
   ```
   find(query="기호1", tabId={탭ID}) → left_click
   ```
3. **"입력 문자" 필드에 직접 입력** (가장 안정적):
   ```
   find(query="입력 문자", tabId={탭ID}) → left_click
   computer(action="triple_click", ...) → 기존 내용 선택
   computer(action="type", text="★", tabId={탭ID})
   ```
4. "넣기" 버튼 클릭:
   ```
   find(query="넣기", tabId={탭ID}) → left_click
   ```
5. 닫기: Escape 또는 닫기 버튼

### ⚠ 주의사항
- 문자 격자 셀 클릭이 "입력 문자" 필드에 반영되지 않는 경우가 있음
- **"입력 문자" 필드에 직접 문자를 타이핑하는 방법이 가장 안정적**
- 문자 영역 카테고리 선택은 `find(query="카테고리명")`으로 접근 (좌표 클릭보다 안정적)

---

## G. 각주/미주

### 각주 삽입
1. 각주를 넣을 위치에 커서 배치
2. 툴바 "각주" 버튼 클릭 또는 메뉴: 입력 → 주석 → 각주
   ```
   find(query="각주", tabId={탭ID}) → left_click
   ```
3. 각주 편집 모드 진입:
   - 스타일 드롭다운이 "각주"로 변경
   - 글자크기 9.0pt, 줄간격 130
   - 페이지 하단에 "1)" 형식의 각주 영역 생성, 커서가 각주 안으로 이동
4. 각주 텍스트 입력:
   ```
   computer(action="type", text="각주 내용", tabId={탭ID})
   ```
5. **⚠ 각주 편집 종료: 본문 영역 더블클릭 필수** (머리말/꼬리말과 동일)
   ```
   computer(action="double_click", coordinate=[본문영역좌표], tabId={탭ID})
   ```
   - 스타일 드롭다운이 "바탕글" 등으로 변경되면 본문 복귀 확인

### 미주 삽입
- 같은 경로에서 "미주" 선택 (각주와 동일한 동작 패턴)

---

## H. 하이퍼링크

### 단축키
```
computer(action="key", text="ctrl+k", tabId={탭ID})
→ wait(0.3)
→ computer(action="key", text="h", tabId={탭ID})
```

### 다이얼로그 구조
- **표시할 텍스트** (textbox): 링크로 표시될 문자열
- **연결 대상** (radio):
  - ● 웹 주소 (기본 선택)
  - ○ 전자 우편 주소
- **웹 주소** (textbox): URL 입력 (기본값 "http://")
- **넣기** 버튼: 하이퍼링크 삽입
- **취소** 버튼

### 절차
1. 링크를 걸 텍스트 선택 (선택 없이 실행하면 표시할 텍스트 직접 입력)
2. 하이퍼링크 다이얼로그 열기 (Ctrl+K → H)
3. 표시할 텍스트 확인/입력:
   ```
   find(query="표시할 텍스트", tabId={탭ID}) → triple_click → type("링크 텍스트")
   ```
4. URL 입력:
   ```
   find(query="웹 주소", tabId={탭ID}) → triple_click → type("https://example.com")
   ```
5. "넣기" 클릭:
   ```
   find(query="넣기", tabId={탭ID}) → left_click
   ```

---

## I. 책갈피

### 단축키
```
computer(action="key", text="ctrl+k", tabId={탭ID})
→ wait(0.3)
→ computer(action="key", text="b", tabId={탭ID})
```

### 절차
1. 책갈피를 넣을 위치에 커서
2. 책갈피 다이얼로그 열기
3. 책갈피 이름 입력 → 추가/확인

---

## J. 메모

1. 입력 → 메모:
   ```
   find(query="입력 메뉴", tabId={탭ID}) → left_click
   find(query="메모", tabId={탭ID}) → left_click
   ```
2. 메모 내용 입력
3. 메모 영역 바깥 클릭하여 완료

---

## K. 웹 동영상

1. 입력 → 웹 동영상:
   ```
   find(query="입력 메뉴", tabId={탭ID}) → left_click
   find(query="웹 동영상", tabId={탭ID}) → left_click  ← 또는 "웹동영상"
   ```
2. 동영상 URL 입력
3. 확인

---

## L. 문단띠

### 단축키
```
computer(action="key", text="alt+n", tabId={탭ID})
→ wait(0.3)
→ computer(action="key", text="l", tabId={탭ID})
```

### 절차
1. 문단띠 다이얼로그에서 디자인 선택
2. 확인

---

## M. 필드 입력

### 단축키
```
computer(action="key", text="ctrl+k", tabId={탭ID})
→ wait(0.3)
→ computer(action="key", text="e", tabId={탭ID})
```

### 용도
- 날짜, 시간, 쪽 번호, 문서 제목 등 자동 필드 삽입
- 필드 종류 선택 → 확인

---

## 에러 처리

### 개체 삽입 후 위치/크기 조정
- 개체 클릭하여 선택 → 핸들 드래그로 크기 조정
- 개체 속성 다이얼로그로 정밀 설정

### 파일 선택 다이얼로그
- OS 네이티브 다이얼로그는 자동화 불가
- 사용자에게 직접 파일 선택 안내

### 수식 편집기 조작 어려움
- 수식 편집기는 별도 UI → read_page로 구조 확인 후 조작
- 간단한 수식은 직접 텍스트 입력 시도

---

## 참조
- 도움말 URL 목록: `references/hdocs-help-urls.md`
- 삽입 관련: `insert/` 하위 페이지
