# 한컴독스 대시보드 (/hdocs-dashboard)

한컴독스(Hancom Docs) 웹 대시보드에서 파일/폴더 관리, 문서 생성, 탐색 등을 수행하는 skill.
에디터 진입 전 단계의 모든 대시보드 작업을 담당한다.

**⚠ 본 에이전트는 HWP(한글) 문서만 지원.** 한셀/한쇼/한워드는 scope 밖.

사용자 요청: $ARGUMENTS

---

## 실행 전 절차

### 1단계: 대시보드 탭 식별
```
tabs_context_mcp → 탭 목록 확인
URL에 "www.hancomdocs.com/ko" 포함된 탭 찾기
```
- 대시보드 탭이 없으면: "한컴독스 대시보드를 브라우저에서 먼저 열어주세요" 안내
- 에디터 탭(`webhwp.hancomdocs.com`)과 혼동 주의 — 이 skill은 대시보드 전용

### 2단계: 현재 페이지 확인
```
screenshot → 현재 어느 페이지인지 확인
```
- URL 패턴으로 구분:
  - `/ko/home` = 홈
  - `/ko/create` = 만들기
  - `/ko/mydrive` = 내 드라이브 (내 파일)
  - `/ko/mydrive/shares` = 공유됨
  - `/ko/trash` = 휴지통

---

## 대시보드 구조

### 좌측 사이드바 (전역 네비게이션)
| 항목 | URL | 설명 |
|------|-----|------|
| 홈 | `/ko/home` | 새 문서 만들기, 최근 문서 |
| 만들기 | `/ko/create` | 새 문서 + 템플릿 |
| 앱 | `/ko/apps` | 앱 다운로드 (자동화 불필요) |
| 내 드라이브 | `/ko/mydrive` | 파일/폴더 관리 (핵심) |

### 내 드라이브 탭 (상단)
| 탭 | 설명 |
|----|------|
| 내 파일 | 내가 소유한 파일/폴더 |
| 공유됨 | 나와 공유된 파일 |
| 즐겨찾기 | 즐겨찾기 등록한 파일 |
| 휴지통 | 삭제된 파일 (30일 후 자동 영구 삭제) |

---

## 핵심 기능

### A. 새 HWP 문서 만들기

**방법 1 — 홈에서:**
```
1. 홈 페이지(`/ko/home`) → find(query="새 문서 만들기") → 클릭
2. 드롭다운에서 find(query="한글") → 클릭
3. → 새 탭에서 HWP 에디터 열림
```

**방법 2 — 내 드라이브에서:**
```
1. "내 파일" 제목 옆 ▼ 버튼 클릭 (find(query="추가 옵션") → 첫 번째)
2. find(query="새 한글") → 클릭
3. → 새 탭에서 HWP 에디터 열림
```

**방법 3 — 만들기 페이지:**
```
1. 좌측 사이드바 "만들기" 클릭
2. find(query="새 한글") → 클릭
```

### B. 파일/폴더 탐색 (내 드라이브)

**내 드라이브 이동:**
```
좌측 사이드바 → find(query="내 드라이브") → 클릭
```

**탭 전환:**
```
find(query="내 파일") / find(query="공유됨") / find(query="즐겨찾기") / find(query="휴지통") → 클릭
```

**폴더 진입:**
```
폴더 이름 더블클릭 → 폴더 내부로 이동
```

**필터:**
```
find(query="문서 유형") → 클릭 → 유형 선택 (한글/한셀/한쇼/한워드/폴더)
find(query="수정한 날짜") → 클릭 → 기간 선택
```

**검색:**
```
find(query="문서, 파일, 폴더 검색") → 클릭 → type("검색어") → Enter
```

### C. 파일 선택

**단일 선택:**
```
파일 행 클릭 → 체크박스 활성화 + 선택 툴바 표시
```

**다중 선택:**
```
첫 파일 클릭 → Ctrl+클릭으로 추가 선택
또는: 체크박스 영역(행 왼쪽) 클릭
```

**전체 선택:**
```
헤더의 전체 선택 체크박스 클릭 (이름 칼럼 좌측)
```

**선택 해제:**
```
선택 툴바의 X 버튼 (find(query="선택 취소"))
또는 빈 영역 클릭
```

### D. 컨텍스트 메뉴 (파일별 ... 버튼)

파일 행 hover 시 나타나는 `...` 버튼으로 접근:
```
1. find(query="{파일명} 추가 옵션") → 클릭 (메뉴 열기)
   또는: 파일 행의 ... 버튼 좌표 클릭
2. find(query="{메뉴항목}") → 클릭
```

**메뉴 항목:**
| 항목 | 설명 |
|------|------|
| 웹으로 열기 | HWP 에디터에서 열기 (새 탭) |
| 공유 | 공유 다이얼로그 열기 |
| 다운로드 | 파일 다운로드 (브라우저 다운로드) |
| 즐겨찾기에 추가 | 즐겨찾기 토글 |
| 이름 바꾸기 | 이름 변경 다이얼로그 |
| 이동 | 이동 다이얼로그 (폴더 트리) |
| 복사 | 복사 다이얼로그 (폴더 트리) |
| 삭제 | 휴지통으로 이동 (확인 없음) |
| 세부 정보 | 우측 세부 정보 패널 |
| 버전 관리 | 버전 관리 페이지 |

**⚠ 메뉴 항목 접근**: `read_page`의 menuitem ref는 DOM 갱신 시 사라질 수 있음 → **`find(query="메뉴항목명")`으로 접근 권장**

### E. 선택 툴바 (파일 선택 시 상단에 표시)

파일 선택 시 상단에 나타나는 일괄 작업 버튼:
```
[X 선택 취소] [N개 항목이 선택됨]     [다운로드] [이동] [복사] [삭제]
```

**⚠ 접근 방법**: 이 버튼들은 accessibility tree에 라벨이 없음 (`read_page` → 빈 button).
- `read_page(filter="interactive")` → 선택 해제 이후의 4개 빈 button이 순서대로: 다운로드, 이동, 복사, 삭제
- 또는 좌표 클릭: screenshot에서 각 버튼 위치 확인 후 클릭

### F. 이름 바꾸기

```
1. 컨텍스트 메뉴 → find(query="이름 바꾸기") → 클릭
2. 다이얼로그: "이름 바꾸기" 제목, 텍스트 입력 필드 (확장자 제외, 이름 부분만 선택됨)
3. 기존 이름이 선택 상태이므로 바로 type("새 이름")
4. find(query="바꾸기") → 클릭
```
- 취소: find(query="취소") → 클릭
- **⚠ 확장자(.hwpx)는 자동 유지됨** — 입력 필드에 포함되지 않음

### G. 이동

```
1. 컨텍스트 메뉴 → find(query="이동") → 클릭  (또는 선택 툴바 이동 버튼)
2. 다이얼로그: 폴더 트리 브라우저
   - ← 뒤로가기 버튼: 상위 폴더로
   - 폴더 클릭: 하위 폴더 진입
   - [+] 새 폴더 버튼: 현재 위치에 새 폴더 생성
3. find(query="여기로 이동") → 클릭
```

### H. 복사

```
1. 컨텍스트 메뉴 → find(query="복사") → 클릭  (또는 선택 툴바 복사 버튼)
2. 다이얼로그: 폴더 트리 브라우저 (이동과 동일 구조)
3. find(query="여기로 복사") → 클릭
```

### I. 삭제

```
1. 컨텍스트 메뉴 → find(query="삭제") → 클릭  (또는 선택 툴바 삭제 버튼)
2. ⚠ 확인 다이얼로그 없음 — 즉시 휴지통으로 이동
3. 하단 토스트: "N개 항목이 휴지통으로 이동" + "실행 취소" 버튼
```
- **실행 취소**: 토스트의 "실행 취소" 클릭 → 원래 위치로 복원 (몇 초 내에만 가능)
- **영구 삭제는 휴지통에서**: 휴지통 → "휴지통 비우기" (30일 후 자동 삭제)

### J. 다운로드

```
1. 컨텍스트 메뉴 → find(query="다운로드") → 클릭  (또는 선택 툴바 다운로드 버튼)
2. 브라우저 기본 다운로드 동작 실행
```
- **⚠ 사용자 확인 필요** (explicit permission)

### K. 공유

```
1. 컨텍스트 메뉴 → find(query="공유") → 클릭
2. 공유 다이얼로그:
   - 이메일/그룹 입력 필드 → type("이메일 주소")
   - 권한 드롭다운: "보기 허용" (기본) / "편집 허용"
   - "초대하기" 버튼
   - 접근 권한 설정: "초대된 사용자만 접근 허용" / "링크를 가진 사용자 접근 허용"
   - "링크 복사" 버튼
```
- **⚠ 공유 설정 변경은 사용자 확인 필요** (explicit permission)

### L. 세부 정보

```
1. 컨텍스트 메뉴 → find(query="세부 정보") → 클릭
2. 우측 패널 열림:
   - "세부 정보" 탭: 접근 권한, 속성(유형/소유자/크기/수정날짜), 문서 요약
   - "활동" 탭: 최근 활동 기록
3. 닫기: 패널 상단 X 버튼 (find(query="닫기"))
```

### M. 버전 관리

```
1. 컨텍스트 메뉴 → find(query="버전 관리") → 클릭
2. 별도 페이지로 이동 (버전 목록)
   - 각 버전: 버전 번호, 수정 일시, ... 메뉴(웹으로 열기/다운로드)
   - "현재 버전" 태그가 최신 버전에 표시
3. 돌아가기: navigate(url="https://www.hancomdocs.com/ko/mydrive")
```
- **⚠ 뒤로가기 화살표(←)가 불안정** → `navigate()` 직접 사용 권장

### N. 새 폴더 만들기

```
1. "내 파일" 제목 옆 ▼ 버튼 (find(query="추가 옵션") → 제목 근처 것) → 클릭
2. find(query="새 폴더") → 클릭
3. 다이얼로그: "폴더 만들기" 제목, 이름 입력 필드 ("새 폴더" 기본값, 전체 선택 상태)
4. type("폴더명") → find(query="만들기") → 클릭
```

### O. 파일 업로드

```
1. "내 파일" 제목 옆 ▼ 버튼 → 클릭
2. find(query="파일 업로드") → 클릭
3. ⚠ OS 파일 선택 다이얼로그 열림 → 자동화 불가
```
- **사용자에게 파일 선택 안내** 필요

### P. 즐겨찾기

```
1. 컨텍스트 메뉴 → find(query="즐겨찾기에 추가") → 클릭
   또는: 파일 행 hover 시 나타나는 ☆ 아이콘 클릭
2. 토글 동작: 추가/제거
```

### Q. 웹으로 열기 (에디터 열기)

```
1. 컨텍스트 메뉴 → find(query="웹으로 열기") → 클릭
2. → 새 탭에서 HWP 에디터 열림
   또는: 파일 이름 더블클릭
```
- 열린 후 `tabs_context_mcp`로 새 에디터 탭 ID 확인

### R. 휴지통

```
1. 내 드라이브 → find(query="휴지통") 탭 클릭
2. 삭제된 파일 목록 표시
   - 각 파일에 ... 메뉴: 복원 / 영구 삭제
3. "휴지통 비우기" 버튼: 전체 영구 삭제
```
- **⚠ 영구 삭제는 복구 불가** — 사용자 확인 필수
- 30일 후 자동 영구 삭제

---

## 에러 복구 패턴

### 컨텍스트 메뉴가 닫히지 않음
```
Escape 키 또는 빈 영역 클릭
```

### 다이얼로그 잔여
```
find(query="취소") 또는 find(query="닫기") → 클릭
```

### 메뉴 항목 ref를 찾을 수 없음
```
read_page의 menuitem ref는 DOM 갱신 시 소실됨
→ find(query="항목명")으로 재탐색
```

### 선택 툴바 버튼 클릭 실패
```
read_page → 라벨 없는 button 4개 (다운로드/이동/복사/삭제 순서)
→ 또는 screenshot → 좌표 클릭
```

---

## 참조
- 에디터 작업: CLAUDE.md 내장 기능(탐색/스타일/표) + `/hdocs-write` 등 skill 사용
- 상위 오케스트레이터: `CLAUDE.md`
