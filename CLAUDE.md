# 한컴독스 웹 자동화 에이전트

한컴독스(Hancom Docs) 웹 에디터를 Claude in Chrome 브라우저 자동화로 제어하는 에이전트 시스템.
이 CLAUDE.md가 오케스트레이터이며, 탐색/스타일/표 기능을 내장하고 비기본 skill은 `.claude/commands/`에서 로드한다.

**⚠ 지원 범위: HWP(한글) 문서 전용.** 한셀/한쇼/한워드 등은 scope 밖.

---

## 에디터 식별

### URL 패턴
```
webhwp.hancomdocs.com/webhwp/?mode=HWP_EDITOR
```

### 탭 제목 패턴
```
*.hwpx - 한컴오피스 Web v2 한글
```

### 에디터 탭 찾기 절차
1. `tabs_context_mcp`로 탭 목록 조회
2. URL에 `webhwp.hancomdocs.com`이 포함된 탭 식별
3. 해당 탭이 없으면 사용자에게 안내 ("한컴독스 에디터를 먼저 열어주세요")
4. 여러 탭이 있으면 사용자에게 선택 요청

---

## 요청 처리 절차

**⚠ 모든 사용자 요청에 대해 반드시 다음 절차를 따른다:**

### 1단계: 계획 출력 (실행 전 필수)
아래 3가지를 **사용자에게 텍스트로 출력**한 후 실행한다:
1. **목적**: 최종 결과물을 한 줄로 정의
2. **산출물 설계**: 문서 구조, 내용 초안, 스타일/서식 등을 마크다운으로 구체 기획
3. **작업 항목**: TODO 목록. 각 항목에 필요한 skill을 `[skill: xxx]` 형태로 명시. skill 라우팅 규칙의 트리거 테이블 참조.

계획 출력 시 다른 방향의 대안도 함께 제시한다.
사용자가 계획을 확인하고 승인/수정 지시를 내린 후 2단계로 진행한다. **⚠ 사용자 확인 없이 실행 금지.**

### 2단계: 실행
계획의 작업 항목을 순차 수행. 각 항목 진입 시 명시된 skill을 Read로 로드한 후 진행.

### 3단계: 검증 및 보고
각 단계 결과 및 최종 결과물이 목적에 부합하는지 확인. 미달 시 보정. 완료 후 결과 간략 보고.

---

## 실행 전 필수 절차

### 1단계: 에디터 탭 식별
```
tabs_context_mcp → 탭 목록 확인
URL에 "webhwp.hancomdocs.com" 포함된 탭 찾기
```
- 에디터 탭이 없으면: "한컴독스 에디터를 브라우저에서 먼저 열어주세요" 안내
- 여러 개면: 사용자에게 어떤 문서를 대상으로 할지 확인

### 2단계: 에디터 상태 확인
```
screenshot → 에디터 현재 상태 시각적 확인
```
- 편집 모드인지 확인 (메뉴바, 도구상자 표시 여부)
- 다이얼로그가 열려있으면 Escape로 먼저 닫기

### 3단계: 문단부호/격자 활성화 ★ 필수
- **⚠ 작업 시작 시 반드시 활성화** (권장이 아닌 **필수**)
- **보기 메뉴 → 표시/숨기기 → 문단 부호** 활성화: 줄바꿈(↵), 빈 줄, 문단 경계 시각적 표시
- **보기 메뉴 → 격자 보기** 활성화: 표/개체 배치 가이드라인 표시
- **⚠ 단축키(Alt+G+T 등) 불가**: Alt+G가 "찾아가기"에 오버라이드됨 → **보기 메뉴 경로만 사용**
- 문단부호가 보여야 표/텍스트 위치를 정확히 파악 가능 → 좌표 클릭 정확도 직접 영향
- **⚠ 새로고침 시 초기화됨** → 새로고침 후 반드시 재활성화

---

## 범용 조작 원칙

### 요소 탐색 (동적 ref 대응)
에디터 UI 요소는 업데이트로 ref ID가 변경될 수 있으므로 **하드코딩 금지**.
항상 동적으로 탐색:
```
방법 1 (권장): find(query="스타일 드롭다운") → ref 획득 → 조작
방법 2: read_page(filter="interactive") → 원하는 요소 찾기 → 조작
방법 3: find(query="확인 버튼") → 클릭
```

### 다이얼로그 조작
1. 단축키 또는 메뉴로 다이얼로그 열기
2. `read_page` 또는 `find`로 다이얼로그 내 요소 탐색
3. `form_input` 또는 `computer(left_click)`으로 값 설정
4. 확인/적용 버튼 `find` → 클릭
5. **주의**: 다이얼로그가 열린 상태에서만 내부 요소 접근 가능
6. **⚠ 다이얼로그 내 Ctrl+A 사용 금지**: HWP 다이얼로그 입력 필드에서 Ctrl+A를 누르면 **에디터 본문 전체가 선택됨** (다이얼로그 필드 내용이 아님). 이후 type()하면 문서 전체가 삭제되어 **복구 불가**
7. **⚠ 다이얼로그 입력 필드 안전한 값 교체 방법**:
   - **권장**: `find`로 필드 찾기 → `left_click` → `key("Home")` → `key("shift+End")` → `type("새 값")`
   - **대안**: `find`로 필드 ref 획득 → `form_input(ref, "새 값")` (단, HWP 커스텀 필드에서는 DOM만 변경되고 내부 상태 미반영될 수 있음)
   - **금지**: `triple_click` → `type()` (일부 HWP 다이얼로그에서 기존 값에 추가됨, 대체 아님)

### 도구 상자(툴바) 접근
서식 도구 상자 요소들은 `find`로 동적 탐색:
- 스타일 드롭다운: `find(query="스타일 드롭다운")` 또는 `find(query="바탕글")`
- 글꼴: `find(query="글꼴 입력")`
- 글자 크기: `find(query="글자 크기")`
- 정렬 버튼: `find(query="왼쪽 정렬")`, `find(query="가운데 정렬")` 등
- 줄간격: `find(query="줄간격")`

### JS 사용 범위 — 에디터 캔버스/스크롤 DOM 변경 금지 ★
HWP 웹 에디터의 **캔버스/스크롤 관련 DOM 속성**을 JavaScript로 직접 수정하면 WASM 엔진 내부 상태와 불일치가 발생한다.
```
[금지]
- hcwoViewScroll.scrollTop 변경 → 스크롤 상태 깨짐, 클릭 좌표 불일치
- pointer-events, display, visibility 등 레이아웃 속성 변경 → 효과 없거나 깨짐
- canvas에 synthetic MouseEvent dispatch → WASM이 무시함 (isTrusted 검사 추정)

[허용]
- F6 "설정..." 버튼 click() 호출 → 기존 DOM 버튼 클릭, 정상 작동
- Ctrl+숫자 매핑 감지 → DOM 읽기 전용
- 다이얼로그 내 요소 읽기/클릭 → 정상 작동
- read_page, find 등 MCP 도구 → 안전

[에디터 상태가 꼬였을 때]
→ 페이지 새로고침 (navigate로 같은 URL 재접속)이 유일한 해결책
```

### 에디터 DOM 3층 구조
HWP 웹 에디터의 캔버스 영역은 3개 레이어로 구성 (위→아래):
```
1. hcwoViewScroll (DIV, position:fixed) — 스크롤/이벤트 처리
2. EditCanvas (CANVAS, position:fixed) — 편집 오버레이 (커서, 선택)
3. PaperCanvas (CANVAS, position:fixed) — 문서 렌더링
```
- 모든 클릭은 최상위 `hcwoViewScroll`에 도달 → WASM 엔진이 처리
- `elementFromPoint()` 결과는 항상 `hcwoViewScroll` (이것은 정상)

### 상태바/UI 정보 JS 읽기
에디터 상태 정보는 **JS DOM을 먼저 시도**한다 (screenshot보다 빠름). 실패(null/빈값) 시 screenshot으로 확인.
```javascript
// 현재 쪽/글자수 (복합 문자열)
document.querySelector('[data-name="status_page"]').textContent
// 개별 정보
document.querySelector('[data-name="cur_page"]').textContent   // "1"
document.querySelector('[data-name="total_page"]').textContent  // "2"
document.querySelector('[data-name="insert_mode"]').textContent // "삽입"
// 현재 스타일
document.querySelector('.e_style_item.on')?.textContent
```
**활용**: 셀 블록 확인(`0/N글자`), 쪽 번호, 현재 스타일. 실패 시 screenshot으로 확인.

---

## 탐색/제어/입력

### A. 텍스트 입력

**기본 텍스트 입력:**
1. 에디터 본문 영역 클릭 (캔버스에 포커스 확보)
2. `computer(action="type", text="입력할 텍스트")` 로 텍스트 입력
3. 줄바꿈: `computer(action="key", text="Enter")`

**단락 단위 입력 (권장):** type("단락 전체") → Enter → type("다음 단락") → Enter ... 반복

**주의사항:**
- 한글 입력 시 IME 조합 중 → 다음 동작 전 짧은 대기(`wait 0.3`) 권장
- 매우 긴 텍스트는 500자 이내 단위로 분할
- 입력 전 커서 위치가 올바른지 확인

**커서 이동:**
- 방향키: `ArrowUp/ArrowDown/ArrowLeft/ArrowRight`
- 문서 처음/끝: `Ctrl+Home` / `Ctrl+End`
- 줄 처음/끝: `Home` / `End`
- 단어 단위: `Ctrl+ArrowLeft/ArrowRight`
- **⚠ Page_Down/Page_Up 사용 금지**: HWP 웹 에디터에서 **텍스트로 입력됨** (페이지 이동 아님!)

**페이지/뷰포트 이동 (커서 이동 아님):**
- 스크롤: `computer(action="scroll", direction="down/up", scroll_amount=5~10)`
- 특정 텍스트로 점프: `Ctrl+F` (**⚠ 표 내부 텍스트는 못 찾는 HWP 버그**)
- 문서 처음/끝: `Ctrl+Home` / `Ctrl+End`

**텍스트 선택:**
- 전체 선택: `Ctrl+A`
- Shift+방향키: 선택 영역 확장
- Shift+Home/End: 줄 시작/끝까지
- Ctrl+Shift+Home/End: 문서 시작/끝까지

**텍스트 삭제:** `Backspace` (앞), `Delete` (뒤), 선택 후 Delete

### B. 새 문서 생성
- 메뉴: `find(query="파일 메뉴")` → 클릭 → `find(query="새 문서")` → 클릭

### C. 문서 저장
- **단축키 (권장)**: `Ctrl+S`
- **다른 이름으로 저장**: 파일 메뉴 → 다른 이름으로 저장 → 파일명 입력 → 확인

### D. 문서 다운로드
- 파일 메뉴 → 다운로드 → 형식 선택
- **주의**: 다운로드는 사용자 확인 필요

### E. 메뉴 열기/닫기
```
메뉴 열기: find(query="{메뉴명} 메뉴") → 클릭
하위 메뉴: find(query="{항목명}") → 클릭
메뉴 닫기: Escape
```

### F. 단축키 실행

`computer(action="key", text="{단축키}")`로 전송.

**주요 단축키:**
| 작업 | 단축키 |
|------|--------|
| 되돌리기 | `ctrl+z` |
| 다시 실행 | `ctrl+shift+z` |
| 복사/붙여넣기/오려두기 | `ctrl+c` / `ctrl+v` / `ctrl+x` |
| 모두 선택 | `ctrl+a` |
| 저장 | `ctrl+s` |
| 찾기 / 바꾸기 | `ctrl+f` / `ctrl+h` |
| 글자 모양 / 문단 모양 | `alt+l` / `alt+t` |
| 스타일 | `F6` |
| 편집 용지 | `F7` |
| 표 만들기 | `alt+n t` |
| 쪽 나누기 | `ctrl+Enter` |
| 문서 처음/끝 | `ctrl+Home` / `ctrl+End` |
| 찾아가기 | `alt+g` |

**⚠ 사용 금지 키:**
| 키 | 이유 |
|----|------|
| `Page_Down` / `Page_Up` | **텍스트로 입력됨** (문서 훼손!) |
| `F5` | 브라우저 새로고침 |
| `Ctrl+L` / `Ctrl+T` / `Ctrl+W` / `Ctrl+N` | 브라우저 탭/창/주소창 조작 |

**복합 단축키 (순차 키):** Alt+N+T 등은 각 키를 순서대로 전송:
```
key("alt+n") → wait(0.3) → key("t")
```

### G. 되돌리기/다시실행
```
되돌리기: ctrl+z    다시실행: ctrl+shift+z
```

### H. 찾기 (Ctrl+F)

**⚠ Ctrl+F는 브라우저 찾기가 아닌 HWP 자체 찾기 다이얼로그를 연다.**

1. `key("ctrl+f")` → 찾기 다이얼로그 열기
2. **⚠ 찾을 방향 필수 사전 설정** (검색어 입력 전!):
   - 기본값 "아래로" → 커서 뒤쪽만 검색 (커서 위 내용 못 찾음!)
   - **권장: `find(query="문서 전체")` → 클릭** → 전체 문서에서 검색
3. **⚠ 필드 값 입력 (안전한 방법):**
   ```
   find(query="찾을 내용") → left_click → Home → Shift+End → type("검색어")
   ```
   - **⚠ triple_click+type 금지**: 기존 값에 추가됨 (대체 아님)
   - **⚠ Ctrl+A 금지**: 에디터 본문 전체가 선택되어 문서 파괴 위험
4. `find(query="다음 찾기")` → 클릭
5. 닫기: Escape

### I. 찾아 바꾸기 (Ctrl+H)

1. `key("ctrl+h")` → 찾아 바꾸기 다이얼로그 열기
2. 구조: "찾을 내용"/"바꿀 내용" 입력, "찾을 방향", 버튼: 바꾸기/다음 찾기/모두 바꾸기/닫기
3. **각 필드 입력**: H절과 동일 안전한 방법 (Home → Shift+End → type)
4. 바꾸기 또는 모두 바꾸기 클릭

### J. 찾아가기 (Alt+G)

특정 쪽, 구역, 줄, 스타일, 조판 부호, 책갈피로 빠르게 이동:
1. `key("alt+g")` → 찾아가기 다이얼로그
2. 이동 대상 선택 (라디오) → 번호 입력 → "가기" 클릭
3. **⚠ Alt+G가 찾아가기를 먼저 잡음** → Alt+G+T 등 순차키 불가

---

## 스타일 관리

### ★ 핵심 원칙: 스타일 우선 + 온디맨드

스타일 기반 작업이 직접 서식 적용보다 효율적이고 일관성을 유지한다.
단, 모든 스타일을 **사전에 일괄 편집하지 않고**, 해당 스타일을 **처음 사용할 때** 확인/편집한다.

**기존 스타일 존중 원칙**: 기존 스타일이 적합하면 그대로 사용. 부적합하면 사용자 확인 후 편집. 없으면 새로 생성.
- **우선순위**: 기존 스타일 사용 > 기존 스타일 편집(확인 후) > 새 스타일 생성
- ✗ 사전 일괄 설정 / ✗ 직접 서식 반복 / ✗ 기존 스타일 무단 변경

**온디맨드**: 본문 즉시 시작 → 스타일 처음 사용 시 F6에서 확인/편집 → 이후 Ctrl+숫자로 반복.

### ⚠ 개요 스타일의 자동 번호 — 수동 번호 중복 금지 ★

HWP 개요 스타일(개요 1~10)은 **자동 번호가 내장**:
- 개요 1 → "1.", "2.", "3." ... / 개요 2 → "가.", "나.", "다." ... / 개요 3 → "1)", "2)", "3)" ...

**⚠ 텍스트에 번호를 수동 포함하면 이중 번호:**
```
[잘못] Ctrl+4(개요 2) → type("1. 제목") → "가. 1. 제목"
[올바름] Ctrl+4(개요 2) → type("제목") → "가. 제목"
```
**원칙: 개요 스타일 사용 시 텍스트에는 제목/내용만 입력, 번호는 스타일이 자동 생성**

### ⚠ 글머리표/문단번호 — 스타일에서 설정, 수동 입력 금지 ★

기호(○, -, ·, □ 등)가 필요한 스타일은 **F6 스타일 속성 편집의 글머리표/문단번호 설정**(D절 참조)으로 기호를 지정한다.
텍스트에 기호를 직접 타이핑하면 스타일 변경 시 기호가 남거나 이중으로 붙는다.

**원칙: 기호가 포함된 스타일은 스타일 속성에서 글머리표/문단번호로 지정. 텍스트에는 내용만 입력.**

### 구조화 문서의 계층 개념
```
제목 스타일 = 절/소절 제목 → 자동 번호 포함, 문단 위 간격으로 섹션 구분
항목 스타일 = 본문 내용 나열 (○, -, · 등) → 왼쪽 여백과 글머리표로 수준 표현
바탕글      = 꾸밈 없는 일반 텍스트 (사용 빈도 낮음)

★ 한국 공문서: 바탕글 거의 안 씀. 대부분 ○/- 등 항목 스타일로 서술
★ 제목 → ○ 항목 → 하위 - 항목 → 제목 → ○ 항목 ... 이 일반적인 흐름
```

### 스타일 편집 후 문서 작성 패턴
```
Ctrl+숫자 → type("내용") → Enter → Ctrl+숫자 → type("내용") → Enter ... 반복
```
글자 크기, 줄간격, 정렬, 여백 등을 매번 수동 지정할 필요 없음.

### 한글 보고서 표준 번호 체계 (★ 핵심)

```
제N장 ○○○             ← 장 (20pt, 볼드)
  N.1 ○○○             ← 절 (15pt, 볼드)
    N.1.1 ○○○         ← 소절 (13pt, 볼드)
      □ 대주제           ← □ (13pt, 내어쓰기)
        ○ 본문 내용       ← ○ 내용1 (12pt, 왼여백10)
          - 세부 내용     ← - 내용2 (12pt, 왼여백24)
            · 상세 내용   ← · 내용3 (11pt, 왼여백34)
          ※ 참고/주의     ← ※ 내용4 (11pt)
      가. 한글 번호       ← 가. (12pt, 내어쓰기)
```
각 수준은 독립 스타일(글꼴 크기·여백·글머리표 포함)로 정의. Ctrl+숫자 하나로 자동 적용.

### 표준 스타일 설정값 (실전 보고서 기준)

**본문 계층 스타일:**

| 스타일명 | 크기 | 줄간격 | 왼쪽여백 | 첫줄 | 정렬 | 글머리표 |
|----------|------|--------|----------|------|------|---------|
| 장 | 20pt | 140% | 10pt | 보통 | 양쪽 | 없음 |
| 1.1 | 15pt | 140% | 0pt | 보통 | 양쪽 | 없음 |
| 1.1.1 | 13pt | 140% | 0pt | 보통 | 양쪽 | 없음 |
| □ | 13pt | 140% | 5pt | 내어쓰기 | 양쪽 | 없음 |
| ○ 내용1 | 12pt | 140% | 10pt | 보통 | 양쪽 | 글머리표 |
| - 내용2 | 12pt | 140% | 24pt | 보통 | 양쪽 | 글머리표 |
| · 내용3 | 11pt | 140% | 34pt | 보통 | 양쪽 | 글머리표 |
| ※ 내용4 | 11pt | 140% | 24pt | 보통 | 양쪽 | 없음 |
| 가. | 12pt | 140% | 10pt | 내어쓰기 | 양쪽 | 없음 |

**표/그림 관련 스타일:**

| 스타일명 | 크기 | 줄간격 | 정렬 | 용도 |
|----------|------|--------|------|------|
| 표 제목 | 11pt | 160% | 가운데 | `<표 N-M> 제목` |
| 그림 제목 | 11pt | 160% | 가운데 | `[그림 N-M] 제목` |
| 표내용 | 10pt | 130% | 양쪽 | 표 셀 본문 |
| 표.그림의 자료및주 | 9pt | 130% | 양쪽 | 출처/주석 |

**⚠ 설정값은 표준 참고용. 문서마다 다르므로 반드시 F6으로 현재 스타일 먼저 파악.**

### 스타일별 일반적 속성

**간단한 문서 (개요 기반):**

| 스타일 | 크기 | 줄간격 | 정렬 | 비고 |
|--------|------|--------|------|------|
| 개요 1 | 18pt | 160% | 가운데 | 진하게 |
| 개요 2 | 14pt | 160% | 양쪽 | 진하게 |
| 개요 3 | 12pt | 160% | 양쪽 | 진하게 |
| 바탕글 | 11pt | 170% | 양쪽 | |

**공문서 변형:**

| 스타일 | 크기 | 줄간격 | 정렬 | 비고 |
|--------|------|--------|------|------|
| 개요 1 | 16pt | 160% | 가운데 | 진하게 |
| 개요 2 | 13pt | 160% | 양쪽 | 진하게 |
| 바탕글 | 12pt | 160% | 양쪽 | |

### 기본 제공 스타일 (커스텀 없는 문서)

바탕글, 본문, 개요 1~10, 머리말/각주/미주/메모, 차례 제목/차례 1~3, 캡션

### A. 스타일 적용

**방법 1 - Ctrl+숫자 (가장 빠름):**
스타일 목록 순서대로 Ctrl+1~9/0으로 즉시 적용:
```
Ctrl+1 = 바탕글 (1번째), Ctrl+2 = 본문 (2번째), Ctrl+3 = 개요 1 (3번째) ...
```
- **주의**: 문서마다 순서가 다를 수 있음 → F6 또는 H절 JS로 먼저 확인
- **주의**: 가끔 여러 번 눌러야 적용되는 에디터 quirk 있음
- 10번째=Ctrl+0, 11번째 이후는 접근 불가 → F6 또는 드롭다운 사용

**방법 2 - F6 다이얼로그:**
1. `key("F6")` → 스타일 다이얼로그 열기
2. `find(query="{스타일명}")` → 클릭
3. `find(query="확인")` → 클릭

**방법 3 - 툴바 스타일 드롭다운:**
`find(query="스타일 드롭다운")` → 클릭 → 목록에서 선택

### B. 현재 스타일 확인
- **툴바**: 스타일 드롭다운에 현재 스타일명 표시
- **F6**: 다이얼로그에서 강조(선택) 표시된 항목 → Escape로 닫기
- **JS**: `document.querySelector('.e_style_item.on')?.textContent`

### C. 스타일 추가 (새 스타일 만들기)
1. F6 → 추가(+) 버튼 클릭
2. **"스타일 추가하기" 다이얼로그**: 이름 입력, 다음 문단 스타일 지정
   - **⚠ 이 다이얼로그에는 글자/문단 설정 없음!**
3. 확인 → F6 메인으로 복귀
4. **속성 설정은 D절 "설정..." 버튼으로 진행**

### D. 스타일 속성 편집 (★ 핵심 - "설정..." 버튼 사용)

**⚠ 편집(연필) 버튼 ≠ 속성 편집**
- **편집(연필)**: 스타일 **이름**과 "다음 문단 스타일"만 변경
- **속성 편집**: F6 메인 우측의 **"설정..." 버튼** (JS 클릭 필수)

#### "설정..." 버튼 클릭 방법 (⚠ JavaScript 필수)

F6 다이얼로그 우측에 3개의 "설정..." 버튼:
- **buttons[0]**: 문단 모양 설정 (정렬, 줄간격, 여백, 첫줄)
- **buttons[1]**: 글자 모양 설정 (글꼴, 크기, 진하게)
- **buttons[2]**: 글머리표/문단번호 설정

**⚠ `find()`나 좌표 클릭으로 접근 불가!** JavaScript DOM 클릭만 작동:
```javascript
const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);
const btns = [];
while (walker.nextNode()) {
  if (walker.currentNode.textContent.trim() === '설정...') {
    const b = walker.currentNode.parentElement.closest('[role="button"]');
    if (b) btns.push(b);
  }
}
btns[1].querySelector('a').click(); // 글자 모양 설정 (예시)
```

#### 전체 속성 편집 워크플로우
```
1. F6 → 편집할 스타일 클릭
2. [글자 모양]: JS btns[1] 클릭 → 글꼴/크기/진하게 설정 → 확인 → F6 복귀
3. [문단 모양]: JS btns[0] 클릭 → 줄간격/정렬/여백 설정 → 확인 → F6 복귀
4. [글머리표]: JS btns[2] 클릭 → 기호 선택 → 확인 → F6 복귀
5. 다른 스타일도 반복 (F6에서 다른 스타일 클릭 → 설정...)
6. 최종 확인 클릭 → F6 닫힘
   ⚠ 확인 시 마지막 선택 스타일이 커서에 적용됨 → 의도치 않으면 Ctrl+Z
```

**문단 모양 다이얼로그 필수 확인 항목:**
```
[줄간격] 제목: 140~160% / 본문: 160~170% / 표 내용: 130%
[왼쪽여백 = 계층 표현] 0pt=최상위 / 5pt=대주제 / 10pt=Lv1 / 24pt=Lv2 / 34pt=Lv3
[문단 간격] 제목: 위 10~20pt (섹션 구분) / 본문: 0pt
[첫줄] 보통=대부분 / 내어쓰기=□,가. 등 / 들여쓰기=장문 본문
```

**글머리표/문단번호 다이얼로그:**
- **글머리표 탭**: "없음" + 17개 프리셋 (●, ○, ■, □, ◆, -, · 등)
- **문단 번호 탭**: 12개 프리셋 (1./2., 가./나., (1)/(2), ①②, 1.1/1.1.1 등)
- 시작 번호: "앞 번호에 이어" / "새 번호 목록 시작"

### E. 스타일 이름 편집 (편집/연필 버튼)
- F6 → 스타일 선택 → 편집(연필) 버튼 → 이름 변경 → 확인
- **⚠ 글자/문단 모양 설정 없음!**

### F. 스타일 삭제
- F6 → 삭제할 스타일 선택 → 삭제(X) 버튼 → 확인
- 기본 스타일(바탕글 등)은 삭제 불가

### G. 배치 스타일 생성 (★ 실전 보고서용)

여러 커스텀 스타일을 효율적으로 생성하는 2패스 워크플로우:

```
[1패스: 이름 일괄 등록]
F6 → 추가(+) → "1.1" 확인 → 추가(+) → "□" 확인 → 추가(+) → "○ 내용1" 확인 → ...
(추가→확인 시 F6 메인으로 자동 복귀, F6 다시 열 필요 없음)

[2패스: 속성 일괄 설정 - JS 클릭 필수]
"1.1" 클릭 → JS 글자모양(15pt,볼드) → 확인 → JS 문단모양(140%,양쪽) → 확인
"□" 클릭 → JS 글자모양(13pt,볼드) → 확인 → JS 문단모양(왼여백5,내어쓰기) → 확인
...
최종 확인 → F6 닫힘
```
- 새 스타일 추가 시 **Ctrl+숫자 매핑 순서 변동** → H절로 재확인
- "다음 스타일" 체이닝 활용: 장→1.1, □→○ 내용1 등 (Enter 시 자동 전환)

### H. Ctrl+숫자 매핑 자동 감지 (★ 검증 완료)

F6 열린 상태에서 JS로 매핑 추출:
```javascript
const dialog = document.querySelector('.modal_dialog');
const anchors = dialog.querySelectorAll('a');
const styles = Array.from(anchors)
  .map(a => a.textContent.trim())
  .filter(t => t.length > 0 && t !== '설정...');
// styles[0]=Ctrl+1, styles[1]=Ctrl+2, ..., styles[8]=Ctrl+9, styles[9]=Ctrl+0
```
- 11번째 이후는 Ctrl+숫자 접근 불가 → F6 또는 드롭다운
- 커스텀 추가 시 순서 변동 → 매번 확인

### I. 스타일 갭 분석 (온디맨드)

커스텀 스타일 5개+ 필요 시 개별보다 일괄 생성이 효율적:
```
1. F6 → JS로 현재 스타일 목록 추출 (H절 코드)
2. 필요 스타일과 비교:
   [실전 보고서] 장, 1.1, □, ○ 내용1, - 내용2, · 내용3, ※ 내용4, 표 제목, 출처
   [간단 보고서] 개요 1~3, 바탕글 → 속성 편집만
3. 갭 = 필요한데 없는 스타일
4. 사용자에게 제안 → 승인 시 G절 배치 생성 / 거부 시 대체 매핑
```

**대체 스타일 매핑 (커스텀 거부 시):**

| 필요 | 대체 | 편집할 속성 |
|------|------|-----------|
| 장 | 개요 1 | 18~20pt, 볼드, 가운데 |
| 1.1 | 개요 2 | 14~15pt, 볼드, 양쪽 |
| 1.1.1 | 개요 3 | 12~13pt, 볼드, 양쪽 |
| □ | 개요 4 | 13pt, 볼드, 왼여백 5pt |
| ○ 내용1~3 | 바탕글 | 11pt, 양쪽 (기호 직접 입력) |

⚠ 대체 매핑은 기호가 스타일에 미포함 → 직접 타이핑 필요. 커스텀이 더 효율적.

### F6 다이얼로그 내부 구조 참고

- **좌측**: 스타일 목록 (listbox)
- **우측 상단**: 선택 스타일 상세 (문단/글자/글머리표 정보, 읽기 전용)
- **우측 "설정..." 3개**: D절 참조 (JS 필수)
- **하단**: 추가(+), 편집(연필), 삭제(X), 확인

---

## 표 생성/편집

### A. 표 만들기

**방법 1 - 메뉴 (권장):**
1. `find(query="입력 메뉴")` 또는 `find(query="표 메뉴")` → 클릭
2. `find(query="표 만들기")` → 클릭
3. 줄 수(행)/칸 수(열) 입력 → 확인

**방법 2 - 단축키:** `key("alt+n")` → wait(0.3) → `key("t")` → 다이얼로그

### "글자처럼 취급" 규칙 ★
```
□ 표: 기본 체크 → 여러 쪽에 걸치는 표만 해제
□ 그림: 무조건 체크
```
- 체크: 표/그림이 텍스트 흐름에 포함 (줄 바꿈 자동)
- 미체크: 텍스트와 겹칠 수 있음 → Enter로 여백 확보 필수

### B. 셀 이동 / 표 탈출

**기본 이동:** `Tab`(다음 셀), `Shift+Tab`(이전 셀), 방향키(셀 내 텍스트 끝에서)

**표 탈출 ★ (Shift+Esc):**
- `Shift+Esc`: 표 안 어디서든 즉시 **표 위쪽**으로 커서 이동
- **⚠ 필수 검증**: Shift+Esc 후 screenshot으로 커서가 표 바깥인지 확인. 커서 깜빡임으로 안 보이면 screenshot 재촬영. **검증 통과 전 본문 입력 금지**. 실패 시 재시도 (최대 3회)
- **표 아래로 이동**: Shift+Esc(위쪽) 후 ArrowDown, 또는 표 아래 클릭. 최후 수단: `Ctrl+End`

**⚠ Ctrl+End는 표 안에서 다르게 동작 ★:**
- **본문**: 문서 마지막으로 이동 (정상)
- **표 셀 편집 모드**: **표의 마지막 셀**로 이동 (문서 끝 아님!)
- 표에서 `Shift+Esc` 후 Ctrl+End → 문서 끝
- **⚠ 표 안에서 Ctrl+End → Enter → Alt+N+T = 표 안에 표 생성** (실수 주의)

**특정 셀 진입 — 좌표 정밀 확인 필수 ★:**
표 셀에 클릭으로 진입할 때 **눈대중 좌표는 높은 확률로 빗나간다**. 표 행은 15~20px로 매우 좁다.
```
[셀 클릭 절차]
1. screenshot 촬영
2. zoom(region=[표 영역])으로 확대 → 셀 텍스트 중앙 좌표 파악 → 역변환
3. 계산된 좌표로 left_click
4. 상태바 "N/M글자" = 셀 진입 성공, "N글자" = 본문 (실패)
5. 실패 시 y를 ±5px 조정 재시도 (최대 3회)
```
- **⚠ Ctrl+F로 셀 진입 금지**: 표 내부 텍스트를 못 찾는 HWP 버그
- **⚠ 표 생성 직후**: 커서가 이미 첫 셀 안 → 클릭 불필요 (Tab으로 이동)

### C. 셀 내용 입력
```
type("A1 내용") → Tab → type("B1 내용") → Tab → type("C1 내용") → Tab
→ 다음 줄 첫 셀로 자동 이동 → type("A2 내용") → Tab → ... 반복
```

### D. 줄/칸 추가/삭제

**단축키 (표 내부):**
```
줄 추가:     Ctrl+Enter       ← 현재 행 아래에 새 행
줄 지우기:   Ctrl+Backspace   ← 커서 위치 행 전체 삭제
칸 추가:     Alt+Insert       ← 현재 열 오른쪽 (웹 확인 필요)
칸 지우기:   Alt+Delete       ← 커서 위치 열 전체 삭제 (웹 확인 필요)
```
- **Tab (마지막 셀)**: 자동으로 새 행 추가
- **마지막 1행만 남은 상태**: Ctrl+Backspace 불가 → Shift+Esc 후 표 개체 선택 → Delete

**표 삭제 (전체):** 표 클릭하여 개체 선택 (8개 핸들) → Delete

### E. 셀 블록 선택 ★ CDP 드래그 (검증 완료)

셀 블록 선택은 CDP `left_click_drag`로 자동화 가능. **시작점 = 내부 경계선 교차점(±3px)**이 핵심.

**⚠ 핵심 원리**: 셀 내부 드래그→텍스트 선택 / **내부 경계선 교차점** 드래그→셀 블록 선택

#### 셀 블록 선택 알고리즘
```
1. 표가 화면에 보이도록 스크롤 → screenshot 촬영

2. screenshot에서 **내부** 셀 경계선 위치 파악:
   [세로 경계선 x] 각 칼럼 사이의 세로 테두리선 x좌표
   [가로 경계선 y] 각 행 사이의 가로 테두리선 y좌표
   ★ 모든 내부 경계선 교차점에서 작동 (헤더|첫행 외에도 가능)
   ⚠ 표 외곽(좌상단/우하단) 경계선은 불가 → 텍스트 선택됨

3. 드래그 시작점 (screenshot 좌표):
   - x: 아무 내부 세로 경계선 x (±3px 이내)
   - y: 아무 내부 가로 경계선 y (±3px 이내)
   ★ 시작점 = 내부 경계선 교차점! 텍스트 중앙·외곽 경계 금지!
   ⚠ 경계선에서 시작 시 양쪽 셀 모두 블록에 포함됨

4. 끝점: 블록 범위 마지막 행 중앙 y, 마지막 칼럼 중앙 x

5. left_click_drag(start_coordinate=[시작], coordinate=[끝])

6. 상태바 확인: "0/N" = 셀 블록 성공 | 다른 값 = 실패
   (JS: status_page textContent에서 "0/" 패턴 확인)

7. 실패 시: 시작점 x,y를 ±3px 조정, 최대 3회 재시도
```

#### 셀 블록 후 사용 가능한 기능 (모두 ✅ 검증)
| 단축키 | 기능 |
|--------|------|
| `P` | 표/셀 속성 다이얼로그 |
| `S` | 셀 나누기 다이얼로그 |
| `M` | 셀 합치기 |
| `W` | 블록 내 셀 너비 균등 |
| `H` | 블록 내 셀 높이 균등 |
| `Ctrl+←/→` | 블록 내 칼럼 너비 조정 |
| `Ctrl+↑/↓` | 블록 내 행 높이 조정 |
| 블록 계산식 | 합계/평균/곱 |

**⚠ 핵심 구분: P/S/M/W/H는 셀 블록 모드에서만 작동**
- 셀 편집 모드(텍스트 편집 중): P→"p" 입력, S→"s" 입력 등 텍스트 오염!
- 셀 블록 모드(상태바 "0/N"): P→속성, M→합치기 등 정상 작동
- **⚠ 좌표 하드코딩 금지**: 표 위치는 문서/줌/스크롤마다 다름 → 반드시 screenshot 기반
- **⚠ 좌표 정밀도**: ±3px 이내 필수 (2px 차이로 성공/실패 갈림)

#### F5 불가 + JS synthetic event 불가
- **F5**: 브라우저 새로고침으로 가로채임 (JS/CDP 우회 모두 실패 확정)
- **JS synthetic event**: `isTrusted=false` → WASM 무시

#### 셀 블록 실패 시 대안
1. **좌표 미세 조정 후 재시도** (±5px, 최대 3회)
2. **처음부터 올바른 구조로 설계** → 합치기 불필요하게
3. **사용자에게 수동 조작 안내**: "마우스로 셀 드래그하여 블록 선택 후 M/W/H 키"
4. **표 삭제 후 재생성**: 구조 변경이 클 때

### F. 셀 나누기 (S) ★ 자동화 가능

단일 셀 나누기는 셀 블록 선택 없이 **커서 위치만으로 실행 가능**:
```
1. 나눌 셀에 커서 이동
2. 표 메뉴 → 셀 나누기 (또는 셀 블록 모드에서 S키)
3. 줄 개수/칸 개수 설정 → 나누기 클릭
```
- 최대 63개까지 분할 가능

### G. 셀 크기 조정

**방법 1: 표/셀 속성 다이얼로그 (정밀, 권장)**
```
셀에 커서 → 표 메뉴 → 표/셀 속성 → "셀" 탭 → "셀 크기 적용" 체크 → 너비/높이 입력
```
- **⚠ 셀 크기 = 해당 줄 전체 높이 + 칸 전체 너비 적용** (개별 셀 불가)
- **⚠ 현재 값보다 작게 설정 불가** (내용에 의해 최소 크기 결정)
- P키는 셀 블록 모드에서만 작동! 셀 편집 모드→"p" 입력됨

**방법 2: 글자 크기에 맞춘 높이 자동 조정**
표 만들기 시 높이="자동" → 셀 내 글자 크기에 따라 행 높이 자동 확장

**셀 높이/너비 균등 (셀 블록 필요 → E절 알고리즘 사용):**
```
H: 셀 높이 균등  W: 셀 너비 균등  Ctrl+←/→: 칼럼 미세 조정  Ctrl+↑/↓: 행 미세 조정
```
- ⚠ W/H는 블록 범위 내 셀에만 적용 (표 전체 아님)
- 셀 블록 실패 시 대안: 표/셀 속성에서 각 행/열 크기를 수치로 동일 입력

### H. 표/셀 속성

**열기:** 표 안 커서 → 표 메뉴 → 표/셀 속성

**6개 탭 구성:**
1. **기본**: 크기(너비/높이), 위치(글자처럼취급, 배치), 가로/세로 정렬
2. **여백/캡션**: 바깥 여백, 캡션 위치/간격
3. **테두리**: 표 외곽/내부 테두리선 스타일/굵기/색상
4. **배경**: 표 배경색, 배경 그림
5. **표** ★ 여러 쪽 표: 쪽 경계 나눔 방식, □제목 줄 자동 반복, 모든 셀 안 여백
6. **셀** ★ 핵심: □셀크기적용(너비/높이mm), □안여백지정, □셀보호, □제목셀, 세로정렬

**⚠ 셀 크기**: 해당 줄 전체 높이 + 칸 전체 너비에 동일 적용. 현재 값보다 작게 불가.
**제목 셀**: 셀 탭 → 제목 셀 체크 → 여러 쪽 표에서 자동 반복

### I. 테두리/배경 설정

1. 셀 또는 셀 블록 선택
2. 표 메뉴 → 테두리/배경
3. 테두리: 선 스타일/굵기/색상, 적용 범위(바깥/안쪽/각각)
4. 배경: 배경색/그라데이션/그림
5. 확인

### J. 블록 계산식

**셀 블록 필요** → E절 알고리즘으로 블록 선택 후:
표 메뉴 → 블록 계산식 → 합계/평균/곱 선택

셀 블록 실패 시: 수동 계산 후 직접 입력, 또는 사용자에게 수동 작업 안내

### K. 배치 셀 입력 (★ 속도 최적화)

**행 단위 배치 입력 (권장):**
```
행1: type("셀1") → Tab → type("셀2") → Tab → type("셀3") → Tab
행2: type("셀4") → Tab → type("셀5") → Tab → type("셀6") → Tab
★ 한글 후 Tab 전에만 wait(0.1), 영문/숫자는 불필요
★ 마지막 셀 Tab → 자동으로 다음 행 첫 셀
```

**대용량 표**: 20행 이상은 10행마다 screenshot 확인

### L. 헤더 행 서식 (★ 검증 완료)

**⚠ 볼드는 Tab으로 다음 셀에 전파되지 않음** → 각 셀마다 개별 적용 필수

**방법 A (권장): 서식+입력 동시**
```
Ctrl+B → type("항목") → Tab → Ctrl+B → type("2023년") → Tab → Ctrl+B → type("2024년") → Tab
★ 가운데 정렬 필요시 각 셀에서 Ctrl+B 전에 정렬 변경
★ 제목 셀 (여러 쪽 표): 표/셀 속성 → 셀 탭 → "제목 셀" 체크
```

**배경색**: 셀 블록 불가 시 셀별 개별 설정 필요 → 실용적 대안: 볼드+가운데만으로 구분

### M. 캡션 + 출처 통합 패턴

**표 캡션 워크플로우:**
```
[표 위: 캡션]
1. 표 제목 스타일 → type("<표 N-M> 제목") → Enter
2. (단위) type("(단위: 억 원, %)") → 오른쪽 정렬 → Enter

[표 생성 + 데이터]
3. 표 만들기 → 배치 입력 (K절)

[표 아래: 주석/출처]
4. Shift+Esc → 검증 → 표 아래 이동
5. type("주: 설명") → Enter (필요시)
6. type("자료: 기관명(연도), 자료명") → Enter
7. Enter (빈 줄) → 본문 스타일 복귀
```

**캡션 번호 체계:**
```
<표 N-M>    N=장번호, M=순번 (예: <표 3-1>)
[그림 N-M]  동일 규칙
장 없는 문서: <표 1>, <표 2> ... 순번만
```

### N. 칼럼 너비 지정

**방법 A: 표/셀 속성** (정밀): 셀 클릭 → 표/셀 속성 → 셀 탭 → 너비 입력 → 반복
**방법 B: 균등 분배**: 대부분 기본 균등으로 충분. 특정 칼럼만 넓게 지정.

**A4 기준 참고:** 항목명 30~40mm, 데이터 20~30mm, 비고/합계 25~35mm, 전체 ~150mm

### O. 표 단축키 총정리

| 단축키 | 기능 | 모드 |
|--------|------|------|
| `Alt+N, T` | 표 만들기 | 본문 |
| `Tab` / `Shift+Tab` | 다음/이전 셀 | 셀 편집 |
| `Shift+Esc` | 표 탈출 (본문 복귀) | 공통 |
| `Ctrl+Enter` | 줄 추가 | 셀 편집 |
| `Ctrl+Backspace` | 줄 지우기 | 셀 편집 |
| `P` | 표/셀 속성 | **셀 블록만** |
| `S` | 셀 나누기 | **셀 블록만** |
| `M` | 셀 합치기 | **셀 블록만** |
| `W` / `H` | 너비/높이 균등 | **셀 블록만** |
| `Ctrl+방향키` | 크기 미세 조정 | **셀 블록만** |
| `F5` | 셀 블록 선택 | **X** (브라우저 새로고침) |
| CDP 드래그 | 셀 블록 선택 | E절 알고리즘 |

---

## 비기본 기능 요약

### 머리말/꼬리말/각주/미주 편집 모드
- 진입: 쪽 메뉴 → 머리말/꼬리말, 또는 입력 → 각주/미주 버튼
- 편집 모드 진입 시: 스타일 드롭다운이 "머리말"/"꼬리말"/"각주" 등으로 변경
  - 머리말/꼬리말: 글자크기 9.0pt, 줄간격 150 / 각주: 9.0pt, 줄간격 130
- **⚠ 편집 종료: 본문 영역 더블클릭 필수** (단일 클릭, Escape 키 모두 작동하지 않음)
- 종료 확인: 스타일 드롭다운이 "바탕글" 등으로 변경되면 본문 복귀 완료

### 문자표 (Ctrl+F10)
- **권장**: "입력 문자" 필드 클릭 → 원하는 문자 직접 타이핑 → "넣기" 클릭
- 문자 격자 클릭은 불안정 → 직접 타이핑 권장

### 개체(도형/글상자) 조작
- **도형 삽입**: 툴바 "도형" → 종류 선택 → 캔버스 드래그
- **글상자 삽입**: Alt+N → B → 캔버스 클릭/드래그
- **Escape 패턴**: 1회=선택모드(8핸들), 2회=선택해제
- **삭제**: 선택 상태에서 Delete / **재진입**: 더블클릭

### 수식 편집기 (부분 자동화)
- **열기**: 입력 메뉴 → 수식
- **수식 코드 입력**: 하단 텍스트 영역에 HWP 수식 문법 타이핑 가능
- **⚠ 다이얼로그 버튼 클릭 불가**: WASM 캔버스 기반 → DOM 미노출
- **워크플로우**: 코드 입력까지 자동화 → 사용자에게 "Escape → 넣기 클릭" 안내

### 장 표지 생성 ★
쪽나누기 → Enter×10~12 → 가운데+20pt+볼드 → 제목 → 쪽나누기
→ hdocs-page E절 참조

---

## 문서 작성 원칙

### 톤앤매너 파악 및 유지

문서 작성 시 톤앤매너는 **사전 정의하지 않고, 실제 문서를 보고 동적으로 판단**:
1. **기존 문서 내용 확인**: `get_page_text` 또는 screenshot
2. **문체 패턴**: 어미(~임, ~이다, ~합니다), 서술/개조식, 경어 수준
3. **구조 패턴**: 번호 체계, 들여쓰기, 단락 구분
4. **서식 패턴**: F6 스타일, 글꼴/크기, 줄간격
5. **일관성 유지**: 파악한 패턴을 새 내용에 그대로 적용

**원칙**: 사용자 지시 최우선 > 기존 문서 맥락 > 새 문서는 용도 확인 후 작성

### 부분적 직접 서식 (예외적 상황에서만)

- 특정 단어만 **진하게/기울임**: 선택 → Ctrl+B / Ctrl+I
- **글자색**: 선택 → find("글자색") → 색상
- **형광펜**: 선택 → find("형광펜") → 색상
- **자간** 미세 조정: 선택 → Alt+L → 자간 값
- **표 내부 셀 서식**: 스타일 불완전 시 직접 크기/정렬 설정

---

## Skill 라우팅 규칙

탐색/스타일/표 기능은 위에 내장. 비기본 기능만 `.claude/commands/hdocs-{skill명}.md`에서 Read로 로드.

### Skill 로드 트리거

| skill | 로드 조건 |
|-------|----------|
| format | 글자/문단 직접 서식 (글자 모양, 문단 모양) |
| page | 용지 설정, 머리말/꼬리말, 쪽번호, 구역 |
| insert | 그림, 도형, 글상자, 수식, 문자표 삽입 |
| write | 문서 전체 자동 생성, 보고서 작성 |
| dashboard | 에디터 탭 없음 / 파일·폴더·내 드라이브 관리 |

**⚠ 트리거 조건에 해당하는 skill은 반드시 Read로 로드한다.**

### 복합 작업 오케스트레이션 ★

**⚠ 요청 1개 = skill 1개가 아니다.** 대부분의 실제 작업은 여러 skill이 필요하다.

- 작업을 단계별로 분해하고, **각 단계에서 필요한 skill을 Read로 로드**한다.
- 실행 계획(요청 처리 절차 4단계)에서 **모든 작업 단계를 먼저 도출**하고, 각 단계마다 어떤 skill이 필요한지 판단한다.
- CLAUDE.md에 내장된 기능(탐색/스타일/표)과 외부 skill 파일을 자유롭게 조합한다.

---

## 편집 속도 최적화 원칙

### 1. 배치 입력 (가장 중요)
- 한 단락 전체를 하나의 type()으로 입력 후 Enter (500자 초과 시에만 분할)
- 스타일 전환(Ctrl+숫자)과 type()만 반복

### 2. 스크린샷 최소화
- 핵심 체크포인트에서만: ① 작업 시작 전 ② 다이얼로그 열림 확인 ③ 작업 완료 후
- **상태 확인은 JS 먼저** (상태바/UI 정보): 실패 시 screenshot으로 확인

### 3. 키보드 단축키 우선
- 스타일: Ctrl+숫자 / 저장: Ctrl+S / 진하게: Ctrl+B

### 4. find() 호출 최소화
- 세션 초반에 `read_page(filter="interactive")`로 주요 ref 파악, 재사용

### 5. 온디맨드 작업 흐름
- 본문 즉시 시작, 설정은 필요할 때만
- 다이얼로그 열닫 횟수 최소화

### 6. 불필요한 wait 제거
- IME 조합 필요한 경우에만 wait(0.3)

### 7. 배치 작업 패턴
- **표**: type→Tab 연속 (K절), 볼드 각 셀 개별 (L절), Shift+Esc 탈출
- **스타일**: 2패스 배치 생성 (G절), Ctrl+숫자 고속 전환

---

## 에러 처리

### 공통
| 증상 | 대응 |
|------|------|
| 다이얼로그 미열림 | 에디터 캔버스 클릭 → 포커스 확보 → 단축키 재시도 |
| 요소 못 찾음 | `read_page`로 전체 확인 → 대체 쿼리 재탐색 |
| 입력 포커스 분실 | 에디터 캔버스 영역 클릭 → 입력 재시도 |
| 메뉴/다이얼로그 잔여 | Escape 키 (여러 번 필요할 수 있음) |

### 스타일 관련
| 증상 | 대응 |
|------|------|
| F6 안 열림 | 본문 클릭 → F6 재시도, 또는 서식 메뉴 → 스타일 |
| 스타일 목록에 없음 | 스크롤 또는 정확한 이름 확인 ("개요1" vs "개요 1") |
| 적용 안 됨 | 텍스트 선택 확인 → 되돌리기 후 재시도 |
| F6 확인 후 의도치 않은 적용 | Ctrl+Z 즉시 취소 (스타일 정의는 유지) |

### 표 관련
| 증상 | 대응 |
|------|------|
| 표 메뉴 비활성 | 커서가 표 안에 있어야 함 → 셀 클릭 후 재시도 |
| 셀 합치기 후 깨짐 | Ctrl+Z 원복 → 다른 방법 또는 표 재생성 |
| 표 안에 갇힘 | Shift+Esc (표 탈출) → screenshot 검증 |

---

## 주의사항

1. **ref ID 하드코딩 금지**: 항상 `find` 또는 `read_page`로 동적 탐색
2. **에디터 포커스 확인**: 모든 키보드 조작 전 에디터 포커스 확인
3. **한글 IME 고려**: 한글 입력 후 **키보드 단축키** 전에만 짧은 대기
4. **스크린샷**: 핵심 체크포인트에서만 촬영
5. **단계별 확인**: 복잡한 작업은 각 단계 완료 확인 후 다음 진행
6. **Page_Down/Page_Up 절대 사용 금지**: 텍스트로 입력되어 문서 훼손

## 참조 파일

- `references/hdocs-help-urls.md`: 공식 도움말 URL 목록
- `.claude/commands/hdocs-format.md`: 글자/문단 직접 서식
- `.claude/commands/hdocs-page.md`: 용지/머리말/꼬리말/쪽번호
- `.claude/commands/hdocs-insert.md`: 그림/도형/수식/문자표 삽입
- `.claude/commands/hdocs-write.md`: 문서 전체 자동 생성
- `.claude/commands/hdocs-dashboard.md`: 대시보드 파일/폴더 관리
